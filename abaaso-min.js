/**
 * Copyright (c) 2011, Jason Mulligan <jason.mulligan@avoidwork.com>
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *     * Redistributions of source code must retain the above copyright
 *       notice, this list of conditions and the following disclaimer.
 *     * Redistributions in binary form must reproduce the above copyright
 *       notice, this list of conditions and the following disclaimer in the
 *       documentation and/or other materials provided with the distribution.
 *     * Neither the name of Jason Mulligan nor the
 *       names of its contributors may be used to endorse or promote products
 *       derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
 * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL JASON MULLIGAN BE LIABLE FOR ANY
 * DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
 * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
 * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
 * ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
 * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */

/**
 * abaaso
 *
 * Events: init           Fires when abaaso is ready; register modules on this event
 *         ready          Fires when the DOM is available
 *         render         Fires when the window resources have loaded
 *         resize         Fires when the window resizes; parameter for listeners is abaaso.client.size
 *         afterCreate    Fires after an Element is created; parameter for listeners is the (new) Element
 *         afterDestroy   Fires after an Element is destroyed; parameter for listeners is the (removed) Element.id value
 *         beforeCreate   Fires when an Element is about to be created; parameter for listeners is the (new) Element.id value
 *         beforeDestroy  Fires when an Element is about to be destroyed; parameter for listeners is the (to be removed) Element
 *         error          Fires when an Error is caught; parameter for listeners is the logged Object (abaaso.error.log[n])
 *         hash           Fires when window.location.hash changes; parameter for listeners is the hash value
 *
 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
 * @link http://abaaso.com/
 * @module abaaso
 * @version 1.7.tech
 */
var $=$||null,abaaso=abaaso||function(){"use strict";var a={cast:function(a,b){try{if(typeof a!=="object")throw Error(j.error.expectedObject);b=b===true;var c=[],d,e;switch(true){case!isNaN(a.length):for(d=0,e=a.length;d<e;d++){c.push(a[d])}break;default:for(d in a){c.push(b?d:a[d])}}return c}catch(f){q(f,arguments,this);return undefined}},contains:function(a,b){try{if(!a instanceof Array)throw Error(j.error.expectedArray);if(/,/.test(b))b=b.explode(",");if(b instanceof Array){var c=[],d=args.length,e=null;for(e=0;e<d;e++){c[e]=a.index(b[e])}return c}return a.index(b)}catch(f){q(f,arguments,this);return undefined}},diff:function(a,b){try{if(!a instanceof Array||!b instanceof Array)throw Error(j.error.expectedArray);var c=a.length>b.length?a:b,d=c===a?b:a,e=[];c.filter(function(a){if(d.indexOf(a)===-1)e.push(a)});return e}catch(f){q(f,arguments,this);return undefined}},first:function(a){try{if(!a instanceof Array)throw Error(j.error.expectedArray);return a[0]}catch(b){q(b,arguments,this);return undefined}},index:function(a,b){try{if(!a instanceof Array)throw Error(j.error.expectedArray);var c=a.length;while(c--){if(a[c]===b)return c}return-1}catch(d){q(d,arguments,this);return-1}},indexed:function(a){try{if(!a instanceof Array)throw Error(j.error.expectedArray);var b,c=0,d=[];for(b in a){if(typeof a[b]!=="function"){d[c]=a[b]instanceof Array?a[b].indexed():a[b];c++}}d.length=c;return d}catch(e){q(e,arguments,this);return undefined}},intersect:function(a,b){try{if(!a instanceof Array||!b instanceof Array)throw Error(j.error.expectedArray);var c=a.length>b.length?a:b,d=c===a?b:a,e=[];c.filter(function(a){if(d.indexOf(a)>-1)e.push(a)});return e}catch(f){q(f,arguments,this);return undefined}},keys:function(a){try{if(!a instanceof Array)throw Error(j.error.expectedArray);var b=[],c=null;for(c in a){if(typeof a[c]!=="function")b.push(c)}return b}catch(d){q(d,arguments,this);return undefined}},last:function(a){try{if(!a instanceof Array)throw Error(j.error.expectedArray);return a.length>1?a[a.length-1]:a.first()}catch(b){q(b,arguments,this);return undefined}},remove:function(a,b,c){try{if(!a instanceof Array)throw Error(j.error.invalidArguments);if(typeof b==="string"){b=a.index(b);if(b===-1)return a}else b=b||0;var d=a.length,e=a.slice((c||b)+1||d);a.length=b<0?d+b:b;a.push.apply(a,e);return a}catch(f){q(f,arguments,this);return undefined}},total:function(a){try{if(!a instanceof Array)throw Error(j.error.expectedArray);var b=0,c;for(c in a){if(typeof a[c]!=="function")b++}return b}catch(d){q(d,arguments,this);return-1}}};var b={items:{},clean:function(){var a;for(a in b.items){if(b.expired(a))b.expire(a)}return},expire:function(a){if(typeof b.items[a]!=="undefined")delete b.items[a];return},expired:function(a){var c=b.items[a];return typeof c!=="undefined"&&c.expires<new Date},get:function(a,c){c=c===true;if(typeof b.items[a]==="undefined")return false;if(c&&b.expired(a)){b.expire(a);return false}return b.items[a]},set:function(a,c,d){if(typeof b.items[a]==="undefined"){b.items[a]={};b.items[a].permission=0}c==="permission"?b.items[a].permission|=d:c==="!permission"?b.items[a].permission&=~d:b.items[a][c]=d;return b.items[a]}};var c={android:function(){return/android/i.test(navigator.userAgent)}(),blackberry:function(){return/blackberry/i.test(navigator.userAgent)}(),chrome:function(){return/chrome/i.test(navigator.userAgent)}(),css3:function(){switch(true){case this.mobile:case this.tablet:case this.chrome&&this.version>5:case this.firefox&&this.version>2:case this.ie&&this.version>8:case this.opera&&this.version>8:case this.safari&&this.version>4:this.css3=true;return true;default:this.css3=false;return false}},expire:0,firefox:function(){return/firefox/i.test(navigator.userAgent)}(),ie:function(){return/msie/i.test(navigator.userAgent)}(),ios:function(){return/ipad|iphone/i.test(navigator.userAgent)}(),linux:function(){return/linux|bsd|unix/i.test(navigator.userAgent)}(),mobile:function(){return/android|blackberry|ipad|iphone|meego|webos/i.test(navigator.userAgent)}(),playbook:function(){return/playbook/i.test(navigator.userAgent)}(),opera:function(){return/opera/i.test(navigator.userAgent)}(),osx:function(){return/macintosh/i.test(navigator.userAgent)}(),safari:function(){return/safari/i.test(navigator.userAgent.replace(/chrome.*/i,""))}(),tablet:function(){return/android|ipad|playbook|webos/i.test(navigator.userAgent)&&(c.size.x>=1e3||c.size.y>=1e3)},webos:function(){return/webos/i.test(navigator.userAgent)}(),windows:function(){return/windows/i.test(navigator.userAgent)}(),version:function(){var a=0;switch(true){case this.chrome:a=navigator.userAgent.replace(/(.*chrome\/|safari.*)/gi,"");break;case this.firefox:a=navigator.userAgent.replace(/(.*firefox\/)/gi,"");break;case this.ie:a=navigator.userAgent.replace(/(.*msie|;.*)/gi,"");break;case this.opera:a=navigator.userAgent.replace(/(.*opera\/|\(.*)/gi,"");break;case this.safari:a=navigator.userAgent.replace(/(.*version\/|safari.*)/gi,"");break;default:a=navigator.appVersion}a=!isNaN(parseInt(a))?parseInt(a):0;this.version=a;return a},allows:function(a,c){try{if(a.isEmpty()||c.isEmpty())throw Error(j.error.invalidArguments);if(!b.get(a,false))return undefined;var d;switch(true){case c.toLowerCase()==="delete":d=!((a.permissions(c).bit&1)===0);break;case c.toLowerCase()==="get":d=!((a.permissions(c).bit&4)===0);break;case/post|put/i.test(c):d=!((a.permissions(c).bit&2)===0);break;default:d=false}return d}catch(e){q(e,arguments,this);return undefined}},permissions:function(a){var c=b.get(a,false),d=!c?0:c.permission,e={allows:[],bit:d,map:{read:4,write:2,"delete":1}};if(d&1)e.allows.push("DELETE");if(d&2)(function(){e.allows.push("PUT");e.allows.push("PUT")})();if(d&4)e.allows.push("GET");return e},request:function(a,d,e,g,k){try{if(/post|put/i.test(d)&&typeof k==="undefined")throw Error(j.error.invalidArguments);if(d.toLowerCase()==="jsonp"){var l=a,m;l.on("afterJSONP",function(a){l.un("afterJSONP").un("failedJSONP");if(typeof e==="function")e(a)});l.on("failedJSONP",function(){l.un("afterJSONP").un("failedJSONP");if(typeof g==="function")g()});do m=n.genId().slice(0,10);while(typeof abaaso.callback[m]!=="undefined");if(typeof k==="undefined")k="callback";a=a.replace(k+"=?",k+"=abaaso.callback."+m);abaaso.callback[m]=function(b){clearTimeout(abaaso.timer["jsonp-"+a]);delete abaaso.timer["jsonp-"+a];delete abaaso.callback[m];l.fire("afterJSONP",b)};f.create("script",{src:a,type:"text/javascript"},$("head")[0]);abaaso.timer["jsonp-"+a]=setTimeout(function(){l.fire("failedJSONP")},3e4)}else{d=d.toLowerCase();var o=new XMLHttpRequest,p=/post|put/i.test(d)?k:null,r=d==="get"&&k instanceof Object?k:null,s=d==="options"?false:b.get(a,false),t=d.capitalize(),u=function(){clearTimeout(abaaso.timer[t+"-"+a]);delete abaaso.timer[t+"-"+a];a.un("received"+t).un("timeout"+t)},v=function(){u();a.fire("failed"+t).un("failed"+t)};if(d==="delete"){a.on("afterDelete",function(){b.expire(a);a.un("afterDelete","expire")},"expire")}a.on("received"+t,u).on("timeout"+t,v).on("after"+t,function(b){a.un("after"+t).un("failed"+t);if(typeof e==="function")e(b)}).on("failed"+t,function(){a.un("failed"+t);if(typeof g==="function")g()}).fire("before"+t).fire("beforeXHR");if(d!=="options"&&a.allows(d)===false){a.fire("failed"+t);return a}abaaso.timer[t+"-"+a]=setTimeout(function(){a.fire("timeout"+t)},3e4);o.onreadystatechange=function(){c.response(o,a,d)};o.open(d.toUpperCase(),a,true);if(p!==null){switch(true){case typeof p.xml!=="undefined":p=p.xml;case p instanceof Document:p=$.xml.decode(p);case typeof p==="string"&&/<[^>]+>[^<]*]+>/.test(p):o.setRequestHeader("Content-type","application/xml");break;case p instanceof Object:o.setRequestHeader("Content-type","application/json");p=h.encode(p);break;default:o.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8")}}if(r!==null)for(i in r){o.setRequestHeader(i,r[i])}if(typeof s==="object"&&typeof s.headers.ETag!=="undefined")o.setRequestHeader("ETag",s.headers.ETag);o.send(p)}return a}catch(w){q(w,arguments,this);return undefined}},response:function(a,d,e){try{var f=e.toLowerCase().capitalize(),g;g=function(a){try{if(!a instanceof Array)throw Error(j.error.expectedArray);var b=0,c=a.length,d;for(d=0;d<c;d++){switch(a[d].toLowerCase()){case"get":b|=4;break;case"post":case"put":b|=2;break;case"delete":b|=1;break}}return b}catch(e){q(e,arguments,this);return 0}};switch(true){case a.readyState===2:d.fire("received"+f);var i=a.getAllResponseHeaders().split("\n"),k=null,l=i.length,m={},n=null,o=new Date,r,s,t;for(k=0;k<l;k++){if(!i[k].isEmpty()){var s=i[k].toString(),t=s.substr(s.indexOf(":")+1,s.length).replace(/\s/,"");s=s.substr(0,s.indexOf(":")).replace(/\s/,"");m[s]=t;if(/allow|access-control-allow-methods/i.test(s))n=t}}switch(true){case typeof m["Cache-Control"]!=="undefined"&&/no/.test(m["Cache-Control"]):case typeof m["Pragma"]!=="undefined"&&/no/.test(m["Pragma"]):break;case typeof m["Cache-Control"]!=="undefined"&&/\d/.test(m["Cache-Control"]):o=o.setSeconds(o.getSeconds()+parseInt(/\d/.match(d["Cache-Control"])[0]));break;case typeof m["Expires"]!=="undefined":o=new Date(m["Expires"]);break;default:o=o.setSeconds(o.getSeconds()+abaaso.client.expire)}b.set(d,"expires",o);b.set(d,"headers",m);b.set(d,"permission",g(n!==null?n.explode(","):[e]));break;case a.readyState===4:switch(a.status){case 200:case 204:case 205:case 301:var u=null,v=abaaso.state,w,x;if(!/delete|options/i.test(e)&&/200|301/.test(a.status)){x=typeof b.get(d,false).headers==="object"?b.get(d,false).headers["Content-Type"]:"";switch(true){case/json/.test(x):w=h.decode(a.responseText);break;case/xml/.test(x):w=p.decode(typeof a.responseXML.xml!=="undefined"?a.responseXML.xml:a.responseText);break;default:if(c.ie){switch(true){case/^\[|\{/.test(a.responseText):w=h.decode(a.responseText);break;case typeof a.responseXML.xml!=="undefined":w=p.decode(a.responseXML.xml);break;case/<[^>]+>[^<]*]+>/.test(a.responseText):w=p.decode(a.responseText);break;default:w=a.responseText}}else w=a.responseText}if(typeof w==="undefined")throw Error(j.error.serverError);b.set(d,"response",w)}r=b.get(d,false);if(e==="options")b.expire(d);if(e!=="options"&&v.header!==null&&(u=r.headers[v.header])&&typeof u!=="undefined"&&!(new v.current)!==u)typeof v.change==="function"?v.change(u):v.current=u;d.fire("afterXHR");switch(a.status){case 200:d.fire("after"+f,e==="options"?r.headers:r.response);break;case 205:d.fire("reset");break;case 301:d.fire("moved",r.response);break}break;case 401:throw Error(j.error.serverUnauthorized);break;case 403:throw Error(j.error.serverForbidden);break;case 405:b.set(d,"!permission",g(e));throw Error(j.error.serverInvalidMethod);break;default:throw Error(j.error.serverError)}break}}catch(y){q(y,arguments,this);d.fire("failed"+f)}return d},size:function(){var a=document.compatMode==="CSS1Compat"&&!c.opera?document.documentElement.clientWidth:document.body.clientWidth,b=document.compatMode==="CSS1Compat"&&!c.opera?document.documentElement.clientHeight:document.body.clientHeight;return{x:a,y:b}}};var d={expire:function(a){if(typeof this.get(a)!=="undefined")this.set(a,"","-1s");return a},get:function(a){return this.list()[a]},list:function(){var a=null,b=null,c=null,d=null,e={};if(typeof document.cookie!=="undefined"&&!document.cookie.isEmpty()){d=document.cookie.split(";");b=d.length;for(a=0;a<b;a++){c=d[a].split("=");e[decodeURIComponent(c[0].toString().trim())]=decodeURIComponent(c[1].toString().trim())}}return e},set:function(a,b,c){c=c.toString()||"";var d="",e=null,f=null,g=["d","h","m","s"],h=g.length;if(!c.isEmpty()){while(h--){if((new RegExp(g[h])).test(c)){f=g[h];e=parseInt(c);break}}if(isNaN(e))throw Error(j.error.invalidArguments);d=new Date;switch(f){case"d":d.setDate(d.getDate()+e);break;case"h":d.setHours(d.getHours()+e);break;case"m":d.setMinutes(d.getMinutes()+e);break;case"s":d.setSeconds(d.getSeconds()+e);break}}if(!d.isEmpty())d="; expires="+d.toUTCString();document.cookie=a.toString().trim()+"="+b+d+"; path=/";return this.get(a)}};var e={decorate:{key:null,keys:{},records:[],total:0,views:{},_uri:null},methods:{batch:function(a,b,c){try{a=a.toString().toLowerCase()||undefined;c=c===true;if(!/^(set|del)$/.test(a)||typeof b!=="object")throw Error(j.error.invalidArguments);var d=this.parentNode,e,f,g;d.fire("beforeDataBatch");if(b instanceof Array){for(e=0,f=b.length;e<f;e++){switch(a){case"del":this.del(b[e],false,c);break;case"set":g=this.key!==null&&typeof b[e][this.key]!=="undefined"?this.key:e;this.set(g,b[e],c);break}}}else{for(e in b){switch(a){case"del":this.del(b[e],false,c);break;case"set":g=this.key!==null&&typeof b[e][this.key]!=="undefined"?this.key:e;g!==e?delete b[e][g]:g=g.toString();this.set(g,b[e],c);break}}}if(a==="del")this.reindex();d.fire("afterDataBatch");return this}catch(h){q(h,arguments,this);return undefined}},clear:function(){var a=this.parentNode;a.fire("beforeDataClear");this.uri=null;this.key=null;this.keys={};this.records=[];this.total=0;this.views={};a.fire("afterDataClear");return this},del:function(a,b,c){try{if(typeof a==="undefined"||typeof a!=="number"&&typeof a!=="string")throw Error(j.error.invalidArguments);b=b!==false;c=c===true;var d=this.parentNode,e,f;if(typeof a==="string"){e=a;a=this.keys[e];if(typeof e==="undefined")throw Error(j.error.invalidArguments);a=a.index}else{e=this.records[a];if(typeof e==="undefined")throw Error(j.error.invalidArguments);e=e.key}f={key:e,record:a,reindex:b};d.fire("beforeDataDelete",f);c||this.uri===null?d.fire("syncDataDelete",f):$.del(this.uri+"/"+e,function(){d.fire("syncDataDelete",f)},function(){d.fire("failedDataDelete",f)});return this}catch(g){q(g,arguments,this);return undefined}},find:function(a,b){try{if(typeof a==="undefined")throw Error(j.error.invalidArguments);var c=[],d=typeof a==="string"?a.explode(","):a,e=[],f,g=d.length,h=this.parentNode,i={},k,l,m,n,o,p,r,s;h.fire("beforeDataFind");n=this.records.first();switch(true){case typeof b==="string":c=b.explode(",");r=c.length;while(r--){if(!n.data.hasOwnProperty(c[r]))throw Error(j.error.invalidArguments)}break;default:for(r in n.data){c.push(r)}}f=c.length;s=this.total;for(r=0;r<s;r++){for(k=0;k<f;k++){for(l=0;l<g;l++){m=c[k];p=d[l];n=new RegExp(p,"gi");o=this.records[r].data[m];if(!i[this.records[r].key]&&n.test(o)){i[this.records[r].key]=r;e.push(this.records[r])}}}}h.fire("afterDataFind",i);return e}catch(t){q(t,arguments,this);return undefined}},get:function(a){try{var b=[],c=this.parentNode,d,e,f;c.fire("beforeDataGet");switch(true){case typeof a==="undefined"||String(a).isEmpty():b=this.records;break;case typeof a==="string"&&typeof this.keys[a]!=="undefined":b=this.records[this.keys[a].index];break;case typeof a==="number":b=this.records[a];break;case a instanceof Array:if(!!isNaN(a[0])||!!isNaN(a[1]))throw Error(j.error.invalidArguments);e=a[0]-1;f=a[1]-1;for(d=e;d<f;d++){if(typeof this.records[d]!=="undefined")b.push(this.records[d])}break}c.fire("afterDataGet",b);return b}catch(g){q(g,arguments,this);return undefined}},reindex:function(){var a=this.total,b=this.parentNode,c;b.fire("beforeDataReindex");this.views={};for(c=0;c<a;c++){if(this.records[c].key.isNumber()){delete this.keys[this.records[c].key];this.keys[c.toString()]={};this.records[c].key=c.toString()}this.keys[this.records[c].key].index=c}b.fire("afterDataReindex");return this},set:function(a,b,c){try{a=a===null?undefined:a.toString();c=c===true;switch(true){case(typeof a==="undefined"||a.isEmpty())&&this.uri===null:case typeof b==="undefined":case b instanceof Array:case b instanceof Number:case b instanceof String:case typeof b!=="object":throw Error(j.error.invalidArguments)}var d=typeof this.keys[a]==="undefined"&&typeof this.records[a]==="undefined"?undefined:this.get(a),e=this.parentNode,f={data:b,key:a,record:d};e.fire("beforeDataSet");c||this.uri===null?e.fire("syncDataSet",f):$[typeof a==="undefined"?"post":"put"](typeof a==="undefined"?this.uri:this.uri+"/"+a,function(a){f["result"]=a;e.fire("syncDataSet",f)},function(){e.fire("failedDataSet")},b);return this}catch(g){q(g,arguments,this);return undefined}},sort:function(a,b){try{if(typeof a==="undefined"||String(a).isEmpty())throw Error(j.error.invalidArguments);b=b===true;var c=this.parentNode,d=a.toCamelCase().replace(/Asc$/,""),e=[],f=[],g,h,i,k;if(!b&&this.views[d]instanceof Array)return this.views[d];if(this.total===0)return this.records;h=new RegExp("\\s+desc","i");g=a.replace(/\s.*$/,"");if(!this.records[0].data.hasOwnProperty(g))throw Error(j.error.invalidArguments);c.fire("beforeDataSort");this.records.filter(function(a){i=String(a.data[g]).trim()+":::"+a.key;e.push(i)});e.sort();if(h.test(a))e.reverse();g=new RegExp(":::(.*)$");e.filter(function(a){k=c.data.keys[g.exec(a)[1]].index;f.push(c.data.records[k])});this.views[d]=f;c.fire("afterDataSort",d);return f}catch(l){q(l,arguments,this);return undefined}},sync:function(){try{if(this.uri===null||this.uri.isEmpty())throw Error(j.error.invalidArguments);var a=this.parentNode,b=n.guid(),c,d;this.uri.on("afterGet",function(c){this.uri.un("afterGet",b);try{var d=c;if(typeof d==="undefined")throw Error(j.error.expectedObject);this.batch("set",d,true);a.fire("afterDataSync")}catch(e){q(e,arguments,this);a.fire("failedDataSync")}},b,this);this.uri.on("failedGet",function(){this.uri.un("failedGet",b);a.fire("failedDataSync")},b,this);a.fire("beforeDataSync");$.get(this.uri);return this}catch(e){q(e,arguments,this);return this}}},register:function(b,d){try{if(b instanceof Array){var e=!isNaN(b.length)?b.length:b.total();while(e--){this.register(b[e],d)}return b}var f,g;f=function(){return this._uri};g=function(a){try{if(a!==null&&a.isEmpty())throw Error(j.error.invalidArguments);this._uri=a;if(a!==null)this.sync()}catch(b){q(b,arguments,this);return undefined}};b=n.object(b);$.genId(b);switch(true){case typeof b.fire==="undefined":b.fire=function(a,b){return $.fire.call(this,a,b)};case typeof b.listeners==="undefined":b.listeners=function(a){return $.listeners(this,a)};case typeof b.on==="undefined":b.on=function(a,b,c,d,e){d=d||this;return $.on.call(this,a,b,c,d,e)};case typeof b.un==="undefined":b.un=function(a,b){return $.un.call(this,a,b)}}b.fire("beforeDataStore");b.data=$.extend(this.methods,this.decorate);b.data.parentNode=b;b.on("syncDataDelete",function(a){var b=this.get(a.record);this.records.remove(a.record);delete this.keys[a.key];this.total--;this.views={};if(a.reindex)this.reindex();this.parentNode.fire("afterDataDelete",b);return this.parentNode},n.guid(),b.data);b.on("syncDataSet",function(b){if(typeof b.record==="undefined"){var c=this.total,d;this.total++;if(typeof b.key==="undefined"){if(typeof b.result==="undefined"){this.fire("failedDataSet");throw Error(j.error.expectedObject)}b.key=this.key===null?a.cast(b.result).first():b.result[this.key];b.key=b.key.toString()}if(typeof b.data[b.key]!=="undefined")b.key=b.data[b.key];this.keys[b.key]={};this.keys[b.key].index=c;this.records[c]={};this.records[c].data=b.data;this.records[c].key=b.key;if(this.key!==null)delete this.records[c].data[this.key];d=this.get(c)}else{if(typeof b.data==="object"){var e;for(e in b){b.record[e]=b.data[e]}this.records[b.record.index]=b.record}else this.records[b.record.index]=b.data;d=this.get(b.record.index)}this.views={};this.parentNode.fire("afterDataSet",d)},n.guid(),b.data);switch(true){case(!c.ie||c.version>8)&&typeof Object.defineProperty==="function":Object.defineProperty(b.data,"uri",{get:f,set:g});break;case typeof b.data.__defineGetter__==="function":b.data.__defineGetter__("uri",f);b.data.__defineSetter__("uri",g);break;default:b.data.uri=null;b.data.setUri=function(a){b.data.uri=a;g.call(b.data,a)}}if(typeof d==="object")b.data.batch("set",d);b.fire("afterDataStore");return b}catch(h){q(h,arguments,this);return undefined}}};var f={"class":function(a,b,d){try{if(a instanceof Array){var e=!isNaN(a.length)?a.length:a.total(),f=null;for(f=0;f<e;f++){this.class(a[f],b,d)}return a}a=n.object(a);d=d!==false;if(!a instanceof Element||String(b).isEmpty())throw Error(j.error.invalidArguments);a.fire("beforeClassChange");var g=a.className.split(" "),e=g.length,f;switch(true){case d:g.push(b);break;case!d:b==="*"?g=[]:g.remove(b);break}g=g.join(" ");c.ie&&c.version<9?a.className=g:a.setAttribute("class",g);a.fire("afterClassChange");return a}catch(h){q(h,arguments,this);return undefined}},clear:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total(),c=null;for(c=0;c<b;c++){this.clear(a[c])}return a}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);a.fire("beforeClear");switch(true){case typeof a.reset==="function":a.reset();break;case typeof a.value!=="undefined":a.update({innerHTML:"",value:""});break;default:a.update({innerHTML:""})}a.fire("afterClear");return a}catch(d){q(d,arguments,this);return undefined}},create:function(a,b,c){try{if(typeof a==="undefined"||String(a).isEmpty())throw Error(j.error.invalidArguments);var d,e;switch(true){case typeof c!=="undefined":c=n.object(c);break;case typeof b!=="undefined"&&(typeof b==="string"||typeof b.childNodes!=="undefined"):c=n.object(b);break;default:c=document.body}if(typeof c==="undefined")throw Error(j.error.invalidArguments);e=typeof b!=="undefined"&&typeof b!=="string"&&typeof b.childNodes==="undefined"&&typeof b.id!=="undefined"&&typeof $("#"+b.id)==="undefined"?b.id:n.genId();if(typeof b!=="undefined"&&typeof b.id!=="undefined")delete b.id;$.fire("beforeCreate",e);e.fire("beforeCreate");d=document.createElement(a);d.id=e;if(typeof b==="object"&&typeof b.childNodes==="undefined")d.update(b);c.appendChild(d);d.fire("afterCreate");$.fire("afterCreate",d);return d}catch(f){q(f,arguments,this);return undefined}},css:function(a){var b,c;b=$.create("style",{type:"text/css"},$("head")[0]);if(b.styleSheet)b.styleSheet.cssText=a;else{c=document.createTextNode(a);b.appendChild(c)}return b},destroy:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total();while(b--){this.destroy(a[b])}return a}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);$.fire("beforeDestroy",a);a.fire("beforeDestroy");m.remove(a.id);a.parentNode.removeChild(a);a.fire("afterDestroy");$.fire("afterDestroy",a.id)}catch(c){q(c,arguments,this)}return undefined},disable:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total();while(b--){this.disable(a[b])}return a}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);if(typeof a.disabled==="boolean"&&!a.disabled){a.fire("beforeDisable");a.disabled=true;a.fire("afterDisable")}return a}catch(c){q(c,arguments,this);return undefined}},enable:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total();while(b--){this.enable(a[b])}return a}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);if(typeof a.disabled==="boolean"&&a.disabled){a.fire("beforeEnable");a.disabled=false;a.fire("afterEnable")}return a}catch(c){q(c,arguments,this);return undefined}},hide:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total(),c=null;for(c=0;c<b;c++){this.hide(a[c])}return a}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);a.fire("beforeHide");switch(true){case typeof a.hidden==="boolean":a.hidden=true;break;default:a["data-display"]=a.style.display;a.style.display="none"}a.fire("afterHide");return a}catch(d){q(d,arguments,this);return undefined}},hidden:function(a){try{a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);return a.style.display==="none"||typeof a.hidden==="boolean"&&a.hidden}catch(b){q(b,arguments,this);return undefined}},position:function(a){try{a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);var b=top=null;if(a.offsetParent){b=a.offsetLeft;top=a.offsetTop;while(a=a.offsetParent){b+=a.offsetLeft;top+=a.offsetTop}}return[b,top]}catch(c){q(c,arguments,this);return undefined}},show:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total(),c=null;for(c=0;c<b;c++){this.show(a[c])}return a}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);a.fire("beforeShow");switch(true){case typeof a.hidden==="boolean":a.hidden=false;break;default:a.style.display=typeof a["data-display"]!=="undefined"&&!a["data-display"].isEmpty()?a["data-display"]:"inherit"}a.fire("afterShow");return a}catch(d){q(d,arguments,this);return undefined}},size:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total(),c=null,d=[];for(c=0;c<b;c++){d.push(this.size(a[c]))}return d}a=n.object(a);if(!a instanceof Element)throw Error(j.error.invalidArguments);var e=function(a){return!isNaN(parseInt(a))?parseInt(a):0};var f=a.offsetHeight+e(a.style.paddingTop)+e(a.style.paddingBottom)+e(a.style.borderTop)+e(a.style.borderBottom),g=a.offsetWidth+e(a.style.paddingLeft)+e(a.style.paddingRight)+e(a.style.borderLeft)+e(a.style.borderRight);return{x:f,y:g}}catch(h){q(h,arguments,this);return undefined}},update:function(a,b){try{if(a instanceof Array){var c=!isNaN(a.length)?a.length:a.total(),d=null;for(d=0;d<c;d++){this.update(a[d],b)}return a}a=n.object(a);b=b||{};if(!a instanceof Element)throw Error(j.error.invalidArguments);a.fire("beforeUpdate");var d;for(d in b){switch(d){case"innerHTML":case"type":case"src":a[d]=b[d];break;case"opacity":a.opacity(b[d]);break;case"class":!b[d].isEmpty()?a.addClass(b[d]):a.removeClass("*");break;case"id":var e=m.listeners;if(typeof e[a.id]!=="undefined"){e[b[d]]=$.clone(e[a.id]);delete e[a.id]};default:a.setAttribute(d,b[d]);break}}a.fire("afterUpdate");return a}catch(f){q(f,arguments,this);return undefined}}};var g={diff:function(a){try{if(typeof a!=="number"||typeof this!=="number")throw Error(j.error.expectedNumber);return Math.abs(this-a)}catch(b){q(b,arguments,this);return undefined}},even:function(a){return a%2===0},odd:function(a){return!(a%2===0)}};var h={decode:function(a){try{return JSON.parse(a)}catch(b){q(b,arguments,this);return undefined}},encode:function(a){try{return JSON.stringify(a)}catch(b){q(b,arguments,this);return undefined}}};var j={common:{back:"Back",cancel:"Cancel",clear:"Clear",close:"Close",cont:"Continue",del:"Delete",edit:"Edit",find:"Find",gen:"Generate",go:"Go",loading:"Loading",next:"Next",login:"Login",ran:"Random",save:"Save",search:"Search",submit:"Submit"},error:{databaseNotOpen:"Failed to open the Database, possibly exceeded Domain quota",databaseNotSupported:"Client does not support local database storage",databaseWarnInjection:"Possible SQL injection in database transaction, use the &#63; placeholder",elementNotCreated:"Could not create the Element",elementNotFound:"Could not find the Element",expectedArray:"Expected an Array",expectedArrayObject:"Expected an Array or Object",expectedBoolean:"Expected a Boolean value",expectedNumber:"Expected a Number",expectedObject:"Expected an Object",invalidArguments:"One or more arguments is invalid",invalidDate:"Invalid Date",invalidFields:"The following required fields are invalid: ",propertyNotFound:"Could not find the requested property",serverError:"Server error has occurred",serverForbidden:"Forbidden to access URI",serverInvalidMethod:"Method not allowed",serverUnauthorized:"Authorization required to access URI"},months:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}};var k={clear:function(){return $.un(window,"message")},send:function(a,b){try{a.postMessage(b,"*");return a}catch(c){q(c,arguments,this);return undefined}},recv:function(a){return $.on(window,"message",a)}};var l={enabled:false,log:false,diff:{x:null,y:null},pos:{x:null,y:null},prev:{x:null,y:null},track:function(a){var b=abaaso.mouse;switch(true){case typeof a==="object":var d,e,f=false;d=a.pageX?a.pageX:(c.ie&&c.version===8?document.documentElement.scrollLeft:document.body.scrollLeft)+a.clientX;e=a.pageY?a.pageY:(c.ie&&c.version===8?document.documentElement.scrollTop:document.body.scrollTop)+a.clientY;switch(true){case b.pos.x!==d:$.mouse.prev.x=b.prev.x=b.pos.x;$.mouse.pos.x=b.pos.x=d;$.mouse.diff.x=b.diff.x=b.pos.x-b.prev.x;f=true;case b.pos.y!==e:$.mouse.prev.y=b.prev.y=b.pos.y;$.mouse.pos.y=b.pos.y=e;$.mouse.diff.y=b.diff.y=b.pos.y-b.prev.y;f=true}if(f&&b.log)n.log(b.pos.x+" : "+b.pos.y);break;case typeof a==="boolean":a?m.add(document,"mousemove",abaaso.mouse.track):m.remove(document,"mousemove");$.mouse.enabled=b.enabled=a;break}return b}};var m={listeners:{},log:false,add:function(a,b,c,d,e,f){try{a=n.object(a);e=e||abaaso;if(a instanceof Array){var g=!isNaN(a.length)?a.length:a.total(),h=null;for(h=0;h<g;h++){this.add(a[h],b,c,d,e?a[h]:e,f)}return a}if(typeof d==="undefined"||!/\w/.test(d))d=n.guid();var i=null,k=m.listeners,l=this.id(a),o,p;if(typeof l==="undefined"||typeof b==="undefined"||typeof c!=="function")throw Error(j.error.invalidArguments);switch(true){case typeof k[l]==="undefined":k[l]={};case typeof k[l][b]==="undefined":k[l][b]={};case typeof k[l][b].active==="undefined":k[l][b].active={};case typeof k[l][b].standby==="undefined":k[l][b].standby={}}p={fn:c,scope:e};if(typeof f==="undefined"){k[l][b].active[d]=p;switch(true){case/body|document|window/i.test(l):i=a;break;default:i=!/\//g.test(l)&&l!=="abaaso"?$("#"+l):null}o=function(c){if(!c)c=window.event;if(typeof c.cancelBubble!=="undefined")c.cancelBubble=true;if(typeof c.preventDefault==="function")c.preventDefault();if(typeof c.stopPropagation==="function")c.stopPropagation();typeof i.fire==="function"?i.fire(b,c):m.fire(a,b,c)};if(i!==null&&b.toLowerCase()!=="afterjsonp"&&typeof i!=="undefined")typeof i.addEventListener==="function"?i.addEventListener(b,o,false):i.attachEvent("on"+b,o)}else{if(typeof k[l][b].standby[f]==="undefined")k[l][b].standby[f]={};k[l][b].standby[f][d]=p}return a}catch(r){q(r,arguments,this);return undefined}},id:function(a){var b;switch(true){case a===abaaso:b="abaaso";break;case a===document:b="document";break;case a===document.body:b="body";break;case a===window:b="window";break;default:b=typeof a.id!=="undefined"?a.id:typeof a.toString==="function"?a.toString():a}return b},fire:function(a,b,c){try{a=n.object(a);if(a instanceof Array){var d=!isNaN(a.length)?a.length:a.total(),e=null;for(e=0;e<d;e++){this.fire(a[e],b,c)}return a}var f=this.id(a),g,h,e,i;if(typeof f==="undefined"||String(f).isEmpty()||typeof a==="undefined"||typeof b==="undefined")throw Error(j.error.invalidArguments);if(abaaso.observer.log)n.log("["+f+"] "+b);i=this.list(a,b).active;if(typeof i!=="undefined"){for(e in i){g=typeof i[e].scope==="object"?i[e].scope:!/\//g.test(i[e].scope)?$(i[e].scope):i[e].scope;h=i[e].fn;typeof c==="undefined"?h.call(g):h.call(g,c)}}$.observer.fired=abaaso.observer.fired++;return a}catch(k){q(k,arguments,this);return undefined}},list:function(a,b){try{if(typeof a==="undefined")throw Error(j.error.invalidArguments);a=n.object(a);var c=this.listeners,d=this.id(a),e;switch(true){case typeof c[d]==="undefined"&&typeof b==="undefined":e={};break;case typeof c[d]!=="undefined"&&(typeof b==="undefined"||String(b).isEmpty()):e=c[d];break;case typeof c[d]!=="undefined"&&typeof c[d][b]!=="undefined":e=c[d][b];break;default:e={active:{},standby:{}}}return e}catch(f){q(f,arguments,this);return undefined}},remove:function(a,b,c){try{a=n.object(a);if(a instanceof Array){var d=!isNaN(a.length)?a.length:a.total(),e=null;for(e=0;e<d;e++){this.remove(a[e],b,c)}return a}var f=null,g=m.listeners,h=this.id(a),i;switch(true){case typeof h==="undefined":case typeof b==="undefined":case typeof g[h]==="undefined":case typeof g[h][b]==="undefined":return a}if(typeof c==="undefined"){delete g[h][b];switch(true){case/body|document|window/i.test(h):f=a;break;default:f=!/\//g.test(h)&&h!=="abaaso"?$("#"+h):null}i=function(c){if(!c)c=window.event;if(typeof c.cancelBubble!=="undefined")c.cancelBubble=true;if(typeof c.preventDefault==="function")c.preventDefault();if(typeof c.stopPropagation==="function")c.stopPropagation();typeof f.fire==="function"?f.fire(b):m.fire(a,b,c)};if(f!==null&&b.toLowerCase()!=="afterjsonp"&&typeof f!=="undefined")typeof f.removeEventListener==="function"?f.removeEventListener(b,i,false):f.detachEvent("on"+b,i)}else if(typeof g[h][b].active[c]!=="undefined"){delete g[h][b].active[c]}return a}catch(j){q(j,arguments,this);return undefined}},state:function(a){try{var b=this.listeners,c,d;for(c in b){for(d in b[c]){b[c][d].standby[$.state.previous]=b[c][d].active;b[c][d].active=typeof b[c][d].standby[a]!=="undefined"?b[c][d].standby[a]:{};if(typeof b[c][d].standby[a]!=="undefined")delete b[c][d].standby[a]}}$.fire(a);return abaaso}catch(d){q(d,arguments,this);return undefined}}};var n={$:function(b,d){d=d===true;if(/,/.test(b))b=b.explode(",");if(b instanceof Array){var e=[],f=b.length,g;for(g=0;g<f;g++){e.push($(b[g],d))}return e}var h;switch(b.charAt(0)){case"#":h=document.querySelector(b);break;default:h=document.querySelectorAll(b);if(h!==null&&!d)h=!c.ie||c.version>8?Array.prototype.slice.call(h):a.cast(h)}if(h===null)h=undefined;return h},alias:function(a,b){try{var c;for(c in b){(function(){var d=c;switch(true){case typeof b[d]==="function"&&typeof b[d].bind==="function":a[d]=function(){return b[d].apply(this,arguments)};break;case b[d]instanceof Object:if(typeof a[d]==="undefined")a[d]={};(function(){abaaso.alias(a[d],b[d])})();break;case typeof b[d]==="function"&&typeof b[d].bind==="undefined":case/boolean|number|string/.test(typeof b[d]):case b[d]===null:a[d]=b[d];break}})()}return a}catch(d){q(d,arguments,this);return undefined}},clone:function(a){try{if(typeof a!=="object")throw Error(j.error.expectedObject);var b={},c;if(typeof a.constructor==="object")b.constructor=a.constructor;if(typeof a.prototype==="object")b.prototype=a.prototype;for(c in a){b[c]=a[c]}return b}catch(d){q(d,arguments,this);return undefined}},define:function(a,b,c){a=a.split(".");c=c||this;if(c===$)c=abaaso;var d=null,e=a.length,f=c;for(d=0;d<e;d++){typeof f[a[d]]==="undefined"?f[a[d]]=d+1<e?{}:typeof b!=="undefined"?b:null:function(){if(d+1>=e)f[a[d]]=typeof b!=="undefined"?b:null}();f=f[a[d]]}return c},defer:function(a,b){var c=n.guid(),d=function(){delete abaaso.timer[c];a()};abaaso.timer[c]=setTimeout(d,b);return undefined},domId:function(a){return"a"+a.replace(/-/g,"").slice(1)},error:function(a,b,c){if(typeof a==="undefined")return;var d={arguments:b,message:typeof a.message!=="undefined"?a.message:a,number:typeof a.number!=="undefined"?a.number&65535:undefined,scope:c,timestamp:(new Date).toUTCString(),type:typeof a.type!=="undefined"?a.type:"TypeError"};if(typeof console!=="undefined")console.error(d.message);abaaso.error.log.push(d);abaaso.fire("error",d);return undefined},extend:function(a,b){try{if(typeof a==="undefined")throw Error(j.error.invalidArguments);if(typeof b==="undefined")b={};var c,d,e=function(){};e.prototype=a;d=new e;d.super=e.prototype;for(c in b){if(b.hasOwnProperty(c))d[c]=b[c]}return d}catch(f){q(f,arguments,this);return undefined}},genId:function(a){switch(true){case a instanceof Array:case a instanceof String:case typeof a==="string":case typeof a!=="undefined"&&typeof a.id!=="undefined"&&/\w/.test(a.id):return a}var b;do b=n.domId(n.guid());while(typeof $("#"+b)!=="undefined");if(typeof a==="object"){a.id=b;return a}else{return b}},guid:function(){var a=function(){return((1+Math.random())*65536|0).toString(16).substring(1)};return(a()+a()+"-"+a()+"-4"+a().substr(0,3)+"-"+a()+"-"+a()+a()+a()).toLowerCase()},loading:function(a){try{if(a instanceof Array){var b=!isNaN(a.length)?a.length:a.total(),c=null;for(c=0;c<b;c++){this.loading(a[c])}return a}var d=abaaso.loading;if(d.url===null)throw Error(j.error.elementNotFound);a=n.object(a);if(typeof a==="undefined")throw Error(j.error.invalidArguments);if(typeof d.image==="undefined"){d.image=new Image;d.image.src=d.url}a.clear();a.create("div",{"class":"loading"}).create("img",{alt:j.common.loading,src:d.image.src});return a}catch(e){q(e,arguments,this);return undefined}},log:function(a){try{console.log(a)}catch(b){q(b,arguments,this)}return undefined},object:function(a){return typeof a==="object"?a:a.toString().charAt(0)==="#"?$(a):a},proto:function(d,e){try{if(typeof d!=="function"&&typeof d!=="object")throw Error(j.error.invalidArguments);var g,h={array:{addClass:function(a){var b=this.length,c=null;for(c=0;c<b;c++){this[c].addClass(a)}return this},contains:function(b){return a.contains(this,b)},css:function(a,b){var c=this.length,d=null;for(d=0;d<c;d++){this[d].css(a,b)}return this},diff:function(b){return a.diff(this,b)},first:function(){return a.first(this)},index:function(b){return a.index(this,b)},indexed:function(){return a.indexed(this)},intersect:function(b){return a.intersect(this,b)},keys:function(){return a.keys(this)},last:function(b){return a.last(this)},on:function(a,b,c,d,e){return $.on.call(this,a,b,c,typeof d!=="undefined"?d:true,e)},remove:function(b){return a.remove(this,b)},removeClass:function(a){var b=this.length,c=null;for(c=0;c<b;c++){this[c].removeClass(a)}return this},text:function(a){return f.update(this,{innerHTML:a})},total:function(){return a.total(this)},update:function(a){return f.update(this,a)}},element:{addClass:function(a){this.genId();return f.class(this,a,true)},create:function(a,b){this.genId();return f.create(a,b,this)},css:function(a,b){var d;this.genId();if(!c.chrome&&(d=a.indexOf("-"))&&d>-1){a=a.replace("-","");a=a.slice(0,d)+a.charAt(d).toUpperCase()+a.slice(d+1,a.length)}this.style[a]=b;return this},disable:function(){return f.disable(this)},enable:function(){return f.enable(this)},get:function(a,c){this.fire("beforeGet");var d=b.get(a),e=n.guid(),f=this;!d?$.get(a,function(a){f.text(a).fire("afterGet")},undefined,c):this.text(d.response).fire("afterGet");return this},hide:function(){this.genId();return f.hide(this)},isAlphaNum:function(){return this.nodeName==="FORM"?false:o.test({alphanum:typeof this.value!=="undefined"?this.value:this.innerText}).pass},isBoolean:function(){return this.nodeName==="FORM"?false:o.test({"boolean":typeof this.value!=="undefined"?this.value:this.innerText}).pass},isDate:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isDate():this.innerText.isDate()},isDomain:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isDomain():this.innerText.isDomain()},isEmail:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isEmail():this.innerText.isEmail()},isEmpty:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isEmpty():this.innerText.isEmpty()},isIP:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isIP():this.innerText.isIP()},isInt:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isInt():this.innerText.isInt()},isNumber:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isNumber():this.innerText.isNumber()},isPhone:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isPhone():this.innerText.isPhone()},isString:function(){return this.nodeName==="FORM"?false:typeof this.value!=="undefined"?this.value.isString():this.innerText.isString()},jsonp:function(a,b,c){var d=this,e=b,f=function(a){var b=d,c=a,f=e,g,h,i;try{if(typeof f!=="undefined"){f=f.replace(/]|'|"/g,"").replace(/\./g,"[").split("[");h=f.length;for(g=0;g<h;g++){c=!!isNaN(f[g])?c[f[g]]:c[parseInt(f[g])];if(typeof c==="undefined")throw Error(j.error.propertyNotFound)}i=c}else{i=a}}catch(k){i=j.error.serverError;q(k,arguments,this)}b.text(i)};$.jsonp(a,f,null,c);return this},loading:function(){return $.loading.create(this)},on:function(a,b,c,d,e){this.genId();return $.on.call(this,a,b,c,typeof d!=="undefined"?d:this,e)},position:function(){this.genId();return f.position(this)},removeClass:function(a){this.genId();return f.class(this,a,false)},show:function(){this.genId();return f.show(this)},size:function(){this.genId();return f.size(this)},text:function(a){var b={};this.genId();if(typeof this.value!=="undefined")b.value=a;if(typeof this.innerHTML!=="undefined")b.innerHTML=a;return this.update(b)},update:function(a){this.genId();return f.update(this,a)},validate:function(){return this.nodeName==="FORM"?o.test(this).pass:typeof this.value!=="undefined"?!this.value.isEmpty():!this.innerText.isEmpty()}},number:{diff:function(a){return $.number.diff.call(this,a)},isEven:function(){return $.number.even(this)},isOdd:function(){return $.number.odd(this)},on:function(a,b,c,d,e){return $.on.call(this,a,b,c,typeof d!=="undefined"?d:this,e)}},shared:{clear:function(){this.genId();this instanceof String?this.constructor=new String(""):f.clear(this);return this},destroy:function(){f.destroy(this)},fire:function(a,b){this.genId();return $.fire.call(this,a,b)},genId:function(){return n.genId(this)},listeners:function(a){this.genId();return $.listeners(this,a)},un:function(a,b){this.genId();return $.un.call(this,a,b)}},string:{allows:function(a){return $.allows(this,a)},capitalize:function(){return this.charAt(0).toUpperCase()+this.slice(1)},del:function(a,b){return c.request(this,"DELETE",a,b)},explode:function(a){return this.split(new RegExp("\\s*"+a+"\\s*"))},get:function(a,b,d){return c.request(this,"GET",a,b,d)},isAlphaNum:function(){return o.test({alphanum:this}).pass},isBoolean:function(){return o.test({"boolean":this}).pass},isDate:function(){return o.test({date:this}).pass},isDomain:function(){return o.test({domain:this}).pass},isEmail:function(){return o.test({email:this}).pass},isEmpty:function(){return!o.test({notEmpty:this}).pass},isIP:function(){return o.test({ip:this}).pass},isInt:function(){return o.test({integer:this}).pass},isNumber:function(){return o.test({number:this}).pass},isPhone:function(){return o.test({phone:this}).pass},isString:function(){return o.test({string:this}).pass},jsonp:function(a,b,d){return c.request(this,"JSONP",a,b,d)},post:function(a,b,d){return c.request(this,"POST",a,b,d)},put:function(a,b,d){return c.request(this,"PUT",a,b,d)},on:function(a,b,c,d,e){return $.on.call(this,a,b,c,typeof d!=="undefined"?d:this,e)},options:function(a){return $.options(this,a)},permissions:function(){return $.permissions(this)},toCamelCase:function(){var a=this.toLowerCase().split(" "),b="",c,d;for(c=0,d=a.length;c<d;c++){b+=c===0?a[c]:String(a[c]).capitalize()}return b},trim:function(){return this.replace(/^\s+|\s+$/g,"")}}};for(g in h[e]){d.prototype[g]=h[e][g]}for(g in h.shared){d.prototype[g]=h.shared[g]}return d}catch(i){q(i,arguments,this);return undefined}},queryString:function(a){a=a||".*";var b={},c=(new RegExp("[\\?&]("+a+"=([^&#]*))")).exec(window.location),d;if(c!==null){c=c[1].split("&");c.filter(function(a){d=a.split("=");switch(true){case d[1].isNumber():d[1]=Number(d[1]);break;case d[1].isBoolean():d[1]=d[1]==="true";break}switch(true){case typeof b[d[0]]==="undefined":b[d[0]]=d[1];break;case!(b[d[0]]instanceof Array):b[d[0]]=[b[d[0]]];default:b[d[0]].push(d[1])}})}return b},tpl:function(b,c){try{switch(true){case typeof b!=="object":case!/object|undefined/.test(typeof c)&&typeof (c=c.charAt(0)==="#"?$(c):$(c)[0])==="undefined":throw Error(j.error.invalidArguments)}if(typeof c==="undefined")c=$("body")[0];var d=document.createDocumentFragment(),e,f;switch(true){case b instanceof Array:f=b.length;for(e=0;e<f;e++){$.create(a.cast(b[e],true)[0],d).text(a.cast(b[e])[0])}break;default:for(e in b){switch(true){case typeof b[e]==="string":$.create(e,d).text(b[e]);break;case b[e]instanceof Object:$.tpl(b[e],$.create(e,d));break}}}c.appendChild(d);return c}catch(g){q(g,arguments,this);return undefined}}};var o={pattern:{alphanum:/^[a-zA-Z0-9]*$/,"boolean":/^(0|1|true|false)?$/,domain:/^[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:\/~\+#]*[\w\-\@?^=%&\/~\+#])?/,email:/^([0-9a-zA-Z]+([_.-]?[0-9a-zA-Z]+)*@[0-9a-zA-Z]+[0-9,a-z,A-Z,.,-]*(.){1}[a-zA-Z]{2,4})+$/,ip:/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/,integer:/(^-?\d\d*$)/,notEmpty:/\w{1,}/,number:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/,phone:/^\([1-9]\d{2}\)\s?\d{3}\-\d{4}$/,string:/\w/},test:function(a){try{if(typeof a==="undefined"||a===null||!a instanceof Object)throw Error(j.error.expectedObject);var b=false,c=[],d=null;if(typeof a.nodeName!=="undefined"&&a.nodeName==="FORM"){var e,f,g,h,i,k,l={},m,n,p,c=[],r={};if(a.id.isEmpty())a.genId();h=$("#"+a.id+":has(input,select)");m=h.length;for(e=0;e<m;e++){g=null;f=o.pattern[h[e].nodeName.toLowerCase()]?o.pattern[h[e].nodeName.toLowerCase()]:!h[e].id.isEmpty()&&o.pattern[h[e].id.toLowerCase()]?o.pattern[h[e].id.toLowerCase()]:"notEmpty";switch(true){case/radio|checkbox/gi.test(h[e].type):if(h[e].name in r){continue}i=document.getElementsByName(h[e].name);n=i.length;for(k=0;k<n;k++){if(i[k].checked){g=i[k].value;r[h[e].name]=true;continue}}break;case/select/gi.test(h[e].type):g=h[e].options[h[e].selectedIndex].value;break;default:g=typeof h[e].value!=="undefined"?h[e].value:h[e].innerText}if(g===null)g="";l[f]=g}p=this.test(l);return p}else{for(var e in a){if(typeof e==="undefined"||typeof a[e]==="undefined"){c.push({test:e,value:a[e]});b=true;continue}d=a[e].charAt(0)==="#"?typeof $(a[e])!=="undefined"?$(a[e]).value?$(a[e]).value:$(a[e]).innerHTML:"":a[e];switch(e){case"date":if(isNaN((new Date(d)).getYear())){c.push({test:e,value:d});b=true}break;case"domain":if(!o.pattern.domain.test(d.replace(/.*\/\//,""))){c.push({test:e,value:d});b=true}break;case"domainip":if(!o.pattern.domain.test(d.replace(/.*\/\//,""))||!o.pattern.ip.test(d)){c.push({test:e,value:d});b=true}break;default:var f=typeof o.pattern[e]!=="undefined"?o.pattern[e]:e;if(!f.test(d)){c.push({test:e,value:d});b=true}break}}return{pass:!b,invalid:c}}}catch(s){q(s,arguments,this);return{pass:false,invalid:{}}}}};var p={decode:function(a){try{if(typeof a!=="string"||a.isEmpty())throw Error(j.error.invalidArguments);var b;if(c.ie){b=new ActiveXObject("Microsoft.XMLDOM");b.async="false";b.loadXML(a)}else{b=(new DOMParser).parseFromString(a,"text/xml")}return b}catch(d){q(d,arguments,this);return undefined}},encode:function(a,b){try{if(typeof a==="undefined")throw Error(j.error.invalidArguments);switch(true){case a!==null&&typeof a.xml!=="undefined":c=a.xml;break;case a instanceof Document:c=(new XMLSerializer).serializeToString(payload);break;default:b=!(b===false);var c=b?"<xml>":"",d=arguments[2]===false?false:true,e,f;e=function(a,b){var c="<n>v</n>";if(/\&|\<|\>|\"|\'|\t|\r|\n|\@|\$/g.test(b))c=c.replace(/v/,"<![CDATA[v]]>");return c.replace(/n/g,a).replace(/v/,b)};switch(true){case typeof a==="boolean":case typeof a==="number":case typeof a==="string":c+=e("item",a);break;case typeof a==="object":for(f in a){c+=$.xml.encode(a[f],typeof a[f]==="object",false).replace(/item|xml/g,!isNaN(f)?"item":f)}break}c+=b?"</xml>":"";if(d)c='<?xml version="1.0" encoding="UTF8"?>'+c}return c}catch(g){q(g,arguments,this);return undefined}}};var q=n.error;return{array:a,callback:{},client:{android:c.android,blackberry:c.blackberry,css3:false,chrome:c.chrome,expire:c.expire,firefox:c.firefox,ie:c.ie,ios:c.ios,linux:c.linux,mobile:c.mobile,opera:c.opera,osx:c.osx,playbook:c.playbook,safari:c.safari,tablet:c.tablet,size:{x:0,y:0},version:0,webos:c.webos,windows:c.windows,del:function(a,b,d){return c.request(a,"DELETE",b,d)},get:function(a,b,d,e){return c.request(a,"GET",b,d,e)},options:function(a,b,d){return c.request(a,"OPTIONS",b,d)},post:function(a,b,d,e){return c.request(a,"POST",b,d,e)},put:function(a,b,d,e){return c.request(a,"PUT",b,d,e)},jsonp:function(a,b,d,e){return c.request(a,"JSONP",b,d,e)},permission:c.permission},cookie:d,data:e,el:f,json:h,label:j,loading:{create:n.loading,url:null},message:k,mouse:l,number:g,observer:{log:m.log,add:m.add,fire:m.fire,fired:0,list:m.list,remove:m.remove},state:{_current:null,header:null,previous:null},validate:o,xml:p,$:n.$,alias:n.alias,allows:c.allows,bootstrap:function(){if(typeof document.getElementsByClassName==="undefined"){document.getElementsByClassName=function(a){var b=document.getElementsByTagName("*"),c=b.length,d=null,e=[],f=new RegExp("(^|\\s)"+a+"(\\s|$)");for(d=0;d<c;d++){if(f.test(b[d].className))e.push(b[d])}return e}}if(typeof Array.prototype.filter==="undefined"){Array.prototype.filter=function(a){"use strict";if(this===void 0||this===null||typeof a!=="function")throw Error(j.error.invalidArguments);var b=null,c=Object(this),d=c.length>>>0,e=[],f=arguments[1];val=null;for(b=0;b<d;b++){if(b in c){val=c[b];if(a.call(f,val,b,c))e.push(val)}}return e}}if(typeof Function.prototype.bind==="undefined"){Function.prototype.bind=function(a){"use strict";var b=this,c=Array.prototype.slice,d=c.call(arguments,1);return function(){return b.apply(a,d.concat(c.call(arguments)))}}}$=abaaso.$.bind($);abaaso.alias($,abaaso);delete $.$;delete $.callback;delete $.init;delete $.observer.log;delete $.state.header;delete $.timer;switch(true){case typeof document.addEventListener==="function":document.addEventListener("DOMContentLoaded",function(){abaaso.init()},false);break;default:abaaso.timer.init=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(abaaso.timer.init);delete abaaso.timer.init;if(typeof abaaso.init==="function")abaaso.init()}},10)}},clean:b.clean,clear:f.clear,clone:n.clone,create:f.create,css:f.css,decode:h.decode,defer:n.defer,define:n.define,del:function(a,b,d){return c.request(a,"DELETE",b,d)},destroy:f.destroy,encode:h.encode,error:n.error,extend:n.extend,fire:function(){var a=typeof arguments[0]==="undefined"?undefined:arguments[0],b=typeof arguments[1]==="undefined"?undefined:arguments[1],c=this===$?abaaso:this;return m.fire.call(m,c,a,b)},genId:n.genId,get:function(a,b,d,e){return c.request(a,"GET",b,d,e)},guid:n.guid,hidden:f.hidden,id:"abaaso",init:function(){delete abaaso.init;delete abaaso.bootstrap;abaaso.error.log=[];$.client.version=abaaso.client.version=c.version();$.client.css3=abaaso.client.css3=c.css3();$.client.size=abaaso.client.size=c.size();$.client.tablet=abaaso.client.tablet=c.tablet();$.state.current=abaaso.state._current;n.proto(Array,"array");n.proto(Element,"element");if(c.ie&&c.version===8)n.proto(HTMLDocument,"element");n.proto(Number,"number");n.proto(String,"string");$.on(window,"hashchange",function(){$.fire("hash",location.hash)},$.guid(),abaaso);$.on(window,"resize",function(){$.client.size=abaaso.client.size=c.size();$.fire("resize",$.client.size)},$.guid(),abaaso);abaaso.timer.clean=setInterval(function(){abaaso.clean()},12e4);var a,b;a=function(){return this._current};b=function(a){try{if(a===null||typeof a!=="string"||this.current===a||a.isEmpty())throw Error(j.error.invalidArguments);$.state.previous=this.previous=this._current;$.state.current=this._current=a;return m.state(a)}catch(b){q(b,arguments,this);return undefined}};switch(true){case(!c.ie||c.version>8)&&typeof Object.defineProperty==="function":Object.defineProperty(abaaso.state,"current",{get:a,set:b});break;case typeof abaaso.state.__defineGetter__==="function":abaaso.state.__defineGetter__("current",a);abaaso.state.__defineSetter__("current",b);break;default:abaaso.state.current=null;abaaso.state.change=function(a){abaaso.state.current=a;b.call(abaaso.state,a)}}$.ready=abaaso.ready=true;$.fire("init").un("init");$.fire("ready").un("ready");abaaso.timer.render=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(abaaso.timer.render);delete abaaso.timer.render;$.fire("render").un("render")}},10);return abaaso},jsonp:function(a,b,d,e){return c.request(a,"JSONP",b,d,e)},listeners:function(a,b){if(a===$)a=abaaso;return m.list.call(m,a,b)},on:function(){var a=typeof arguments[2]==="function",b=a?arguments[0]:this,c=a?arguments[1]:arguments[0],d=a?arguments[2]:arguments[1],e=a?arguments[3]:arguments[2],f=a?arguments[4]:arguments[3],g=a?arguments[5]:arguments[4];if(b===$)b=abaaso;if(typeof f==="undefined")f=b;return m.add.call(m,b,c,d,e,f,g)},options:function(a,b,d){return c.request(a,"OPTIONS",b,d)},permissions:c.permissions,position:f.position,post:function(a,b,d,e){return c.request(a,"POST",b,d,e)},put:function(a,b,d,e){return c.request(a,"PUT",b,d,e)},queryString:n.queryString,ready:false,store:function(a,b){return e.register.call(e,a,b)},timer:{},tpl:n.tpl,un:function(){var a=typeof arguments[2]!=="undefined",b=a?arguments[0]:this,c=a?arguments[1]:arguments[0],d=a?arguments[2]:arguments[1];if(b===$)b=abaaso;return m.remove.call(m,b,c,d)},update:f.update,version:"1.7.tech"}}();if(typeof abaaso.bootstrap==="function")abaaso.bootstrap()