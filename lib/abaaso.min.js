/**
 * abaaso
 *
 * @author Jason Mulligan <jason.mulligan@avoidwork.com>
 * @copyright 2012 Jason Mulligan
 * @license BSD-3 <https://github.com/avoidwork/abaaso/blob/master/LICENSE>
 * @link http://abaaso.com
 * @module abaaso
 * @version 3.3.13
 */
(function(e){var t=e.document,n=e.location,r=e.navigator,s=typeof t=="undefined",o,u,a,f;s&&(f=require("url"),u=require("http"),a=require("https"),typeof Storage=="undefined"&&(localStorage=require("localStorage")),typeof XMLHttpRequest=="undefined"&&(XMLHttpRequest=null)),o=e.abaaso||function(){"use strict";function A(){this.error=[],this.fulfill=[],this.parentNode=null,this.outcome=null,this.state=L.state.initial}var l,c,h,p,d={add:function(e,t){return d.contains(e,t)||e.push(t),e},cast:function(e,t){t=t===!0;var n=[];if(!isNaN(e.length))if(!m.ie||m.version>8)n=Array.prototype.slice.call(e);else try{n=Array.prototype.slice.call(e)}catch(r){_.iterate(e,function(e,t){t!=="length"&&n.push(e)})}else t?n=d.keys(e):_.iterate(e,function(e){n.push(e)});return n},chunk:function(e,t){var n=[],r=C.round(e.length/t,"up"),i=0,s=-1;while(++s<r)i=s*t,n.push(d.limit(e,i,t));return n},clear:function(e){return e.length>0?d.remove(e,0,e.length):e},clone:function(e){return _.clone(e)},contains:function(e,t){return d.index(e,t)>-1},collect:function(e,t){var n=[];return d.each(e,function(e){n.push(t(e))}),n},compact:function(e,t){var n=/null|undefined/,r=[];return r=e.filter(function(e){if(!n.test(e))return!0}),t?r.length<e.length?r:null:r},diff:function(e,t){var n=[];return d.each(e,function(e){d.contains(t,e)||n.add(e)}),d.each(t,function(t){d.contains(e,t)||n.add(t)}),n},each:function(e,t){var n=e.length,r=-1,i;while(++r<n){i=t.call(e,e[r],r);if(i===!1)break}return e},empty:function(e){return e.length===0},equal:function(e,t){return S.encode(e)===S.encode(t)},fill:function(e,t,n,r){var i=typeof t=="function",s=e.length,o=isNaN(n)?0:n,u=isNaN(r)?s-1:o+r;u>s-1&&(u=s-1);for(;o<=u;o++)e[o]=i?t(e[o]):t;return e},first:function(e){return e[0]},flat:function(e){var t=[];return t=e.reduce(function(e,t){return e.concat(t)},t),t},index:function(e,t){return e.indexOf(t)},indexed:function(e){var t=[];return _.iterate(e,function(e,n){typeof e=="object"?t=t.concat(d.indexed(e)):t.push(e)}),t},intersect:function(e,t){var n=e.length>t.length?e:t,r=n===e?t:e;return n.filter(function(e){return d.contains(r,e)})},keep_if:function(e,t){if(typeof t!="function")throw Error(x.error.invalidArguments);var n=[],r=[];return n=e.filter(t),r=d.diff(e,n),d.each(r,function(t,n){d.remove(e,d.index(e,t))}),e},keys:function(e){var t=[];return typeof Object.keys=="function"?t=Object.keys(e):_.iterate(e,function(e,n){t.push(n)}),t},last:function(e,t){var n=e.length-1;return isNaN(t)||t===1?e[n]:d.limit(e,n- --t,n)},limit:function(e,t,n){var r=[],i=t-1,s=t+n;while(++i<s)typeof e[i]!="undefined"&&r.push(e[i]);return r},max:function(e){return d.last(e.sort(d.sort))},mean:function(e){return d.sum(e)/e.length},median:function(e){var t=e.length,n=C.round(t/2,"down"),r=e.sort(d.sort);return C.odd(t)?r[n]:(r[n-1]+r[n])/2},min:function(e){return e.sort(d.sort)[0]},mode:function(e){var t={},n=0,r=0,i=[],s;return d.each(e,function(e){isNaN(t[e])?t[e]=1:++t[e]}),n=d.max(d.cast(t)),_.iterate(t,function(e,t){e===n&&i.push(C.parse(t))}),r=i.length,r>0&&(s=r===1?i[0]:i),s},range:function(e){return d.max(e)-d.min(e)},rassoc:function(e,t){var n;return d.each(e,function(r,i){if(r[1]===t)return n=e[i],!1}),n},reject:function(e,t){return d.diff(e,e.filter(t))},replace:function(e,t){return d.remove(e,0,e.length),d.each(t,function(t){e.push(t)}),e},remove:function(e,t,n){if(isNaN(t)){t=e.index(t);if(t===-1)return e}else t=t||0;var r=e.length,i=e.slice((n||t)+1||r);return e.length=t<0?r+t:t,e.push.apply(e,i),e},remove_if:function(e,t){if(typeof t!="function")throw Error(x.error.invalidArguments);var n=[];return n=e.filter(t),d.each(n,function(t,n){d.remove(e,d.index(e,t))}),e},remove_while:function(e,t){if(typeof t!="function")throw Error(x.error.invalidArguments);var n=[];return d.each(e,function(e){var r=t(e);if(r===!1)return!1;n.push(e)}),d.each(n,function(t,n){d.remove(e,d.index(e,t))}),e},rest:function(e,t){return t=t||1,t<1&&(t=1),d.limit(e,t,e.length)},rindex:function(e,t){var n=-1;return d.each(e,function(e,r){e===t&&(n=r)}),n},rotate:function(e,t){var n=[],r=e.length;return t===0?n=e:(t<0?t+=r:t--,n=d.limit(e,t,r),n=n.concat(d.limit(e,0,t))),n},series:function(e,t,n){e=e||0,t=t||e,n=n||1;var r=[],i=-1,s=Math.max(0,Math.ceil((t-e)/n));while(++i<s)r[i]=e,e+=n;return r},split:function(e,t){var n=[],r=e.length,i=Math.ceil(r/t),s=Math.floor(r/t),o=Math.ceil(r/i),u=!1,a=0,f=-1;C.diff(r,t*i)>i&&(o=r-s*t+s-1);while(++f<t)!u&&o<t&&f===o&&(--i,u=!0),f>0&&(a+=i),n.push(d.limit(e,a,i));return n},sort:function(e,t){var n=!1,r=0;return!isNaN(e)&&!isNaN(t)&&(n=!0),e=n?C.parse(e):String(e),t=n?C.parse(t):String(t),e<t?r=-1:e>t&&(r=1),r},sum:function(e){var t=0;return e.length>0&&(t=e.reduce(function(e,t){return e+t})),t},take:function(e,t){return d.limit(e,0,t)},total:function(e){return d.indexed(e).length},toObject:function(e){var t={},n=e.length;while(n--)t[n.toString()]=e[n];return t},unique:function(e,t){var n=[];return d.each(e,function(e){d.add(n,e)}),n},zip:function(e,t){var n=[];return t instanceof Array||(t=typeof t=="object"?d.cast(t):[t]),d.each(t,function(e,t){e instanceof Array||(this[t]=[e])}),d.each(e,function(e,r){n[r]=[e],d.each(t,function(e){n[r].push(e[r]||null)})}),n}},v={items:{},clean:function(){return _.iterate(v.items,function(e,t){v.expired(t)&&v.expire(t)})},expire:function(e,t){return t=t===!0,typeof v.items[e]!="undefined"?(delete v.items[e],t||e.fire("beforeExpire, expire, afterExpire"),!0):!1},expired:function(e){var t=v.items[e];return typeof t!="undefined"&&typeof t.expires!="undefined"&&t.expires<new Date},get:function(e,t){return t=t!==!1,typeof v.items[e]=="undefined"?!1:t&&v.expired(e)?(v.expire(e),!1):_.clone(v.items[e])},set:function(e,t,n){return typeof v.items[e]=="undefined"&&(v.items[e]={},v.items[e].permission=0),t==="permission"?v.items[e].permission|=n:t==="!permission"?v.items[e].permission&=~n:v.items[e][t]=n,v.items[e]}},m={android:function(){return!s&&/android/i.test(r.userAgent)}(),blackberry:function(){return!s&&/blackberry/i.test(r.userAgent)}(),chrome:function(){return!s&&/chrome/i.test(r.userAgent)}(),firefox:function(){return!s&&/firefox/i.test(r.userAgent)}(),ie:function(){return!s&&/msie/i.test(r.userAgent)}(),ios:function(){return!s&&/ipad|iphone/i.test(r.userAgent)}(),linux:function(){return!s&&/linux|bsd|unix/i.test(r.userAgent)}(),mobile:function(){o.client.mobile=this.mobile=!s&&(/blackberry|iphone|webos/i.test(r.userAgent)||/android/i.test(r.userAgent)&&(o.client.size.height<720||o.client.size.width<720))},playbook:function(){return!s&&/playbook/i.test(r.userAgent)}(),opera:function(){return!s&&/opera/i.test(r.userAgent)}(),osx:function(){return!s&&/macintosh/i.test(r.userAgent)}(),safari:function(){return!s&&/safari/i.test(r.userAgent.replace(/chrome.*/i,""))}(),tablet:function(){o.client.tablet=this.tablet=!s&&(/ipad|playbook|webos/i.test(r.userAgent)||/android/i.test(r.userAgent)&&(o.client.size.width>=720||o.client.size.width>=720))},webos:function(){return!s&&/webos/i.test(r.userAgent)}(),windows:function(){return!s&&/windows/i.test(r.userAgent)}(),version:function(){var e=0;switch(!0){case this.chrome:e=r.userAgent.replace(/(.*chrome\/|safari.*)/gi,"");break;case this.firefox:e=r.userAgent.replace(/(.*firefox\/)/gi,"");break;case this.ie:e=parseInt(r.userAgent.replace(/(.*msie|;.*)/gi,"")),t.documentMode<e&&(e=t.documentMode);break;case this.opera:e=r.userAgent.replace(/(.*opera\/|\(.*)/gi,"");break;case this.safari:e=r.userAgent.replace(/(.*version\/|safari.*)/gi,"");break;default:e=typeof r!="undefined"?r.appVersion:0}return e=isNaN(parseInt(e))?0:parseInt(e),o.client.version=this.version=e,e},allows:function(e,t){if(e.isEmpty()||t.isEmpty())throw Error(x.error.invalidArguments);if(!v.get(e,!1))return undefined;t=t.toLowerCase();var n=!1,r=0;return t==="delete"?r=1:/^(head|get|options)$/.test(t)?r=4:/^(post|put)$/.test(t)&&(r=2),n=(m.permissions(e,t).bit&r)!==0,n},bit:function(e){var t=0;return d.each(e,function(e){switch(e.toLowerCase()){case"head":case"get":case"options":t|=4;break;case"post":case"put":t|=2;break;case"delete":t|=1}}),t},cors:function(e){return!s&&e.indexOf("//")>-1&&e.indexOf("//"+n.host)===-1},headers:function(e,t,n){var r=String(e.getAllResponseHeaders()).trim().split("\n"),i={},s={},o=null,u=new Date,a=m.cors(t),f=/.*:\s+/,c=/:.*/,h=/^allow$/i,p=/^access-control-allow-methods$/i,g;g=function(e){var t=[];return d.each(e.explode("-"),function(e){t.push(e.capitalize())}),t.join("-")},d.each(r,function(e){var t,n;n=e.replace(f,""),t=e.replace(c,""),t=t.indexOf("-")===-1?t.capitalize():g(t),i[t]=n;if(a&&p.test(t)||h.test(t))return o=n,!1});switch(!0){case typeof i["Cache-Control"]!="undefined"&&/no/.test(i["Cache-Control"]):case typeof i.Pragma!="undefined"&&/no/.test(i.Pragma):break;case typeof i["Cache-Control"]!="undefined"&&/\d/.test(i["Cache-Control"]):u=u.setSeconds(u.getSeconds()+parseInt(/\d{1,}/.exec(i["Cache-Control"])[0]));break;case typeof i.Expires!="undefined":u=new Date(i.Expires);break;default:u=u.setSeconds(u.getSeconds()+l.expires)}return s.expires=u,s.headers=i,s.permission=m.bit(o!==null?o.explode():[n]),n!=="head"&&(v.set(t,"expires",s.expires),v.set(t,"headers",s.headers),v.set(t,"permission",s.permission)),s},parse:function(e,t){t=t||"";var n,r;switch(!0){case(/json|plain|javascript/.test(t)||t.isEmpty())&&Boolean(r=S.decode(/[\{\[].*[\}\]]/.exec(e.responseText),!0)):n=r;break;case/xml/.test(t)&&String(e.responseText).isEmpty()&&e.responseXML!==null:n=H.decode(typeof e.responseXML.xml!="undefined"?e.responseXML.xml:e.responseXML);break;case/<[^>]+>[^<]*]+>/.test(e.responseText):n=H.decode(e.responseText);break;default:n=e.responseText}return n},permissions:function(e){var t=v.get(e,!1),n=t?t.permission:0,r={allows:[],bit:n,map:{read:4,write:2,"delete":1}};return n&1&&r.allows.push("DELETE"),n&2&&function(){r.allows.push("POST"),r.allows.push("PUT")}(),n&4&&r.allows.push("GET"),r},jsonp:function(t,n,r,i){var s=L.factory(),o,u,a;typeof p=="undefined"&&(typeof e.abaaso=="undefined"&&_.define("abaaso.callback",{},e),p="abaaso");switch(!0){case typeof i=="undefined":case i===null:case i instanceof Object&&(i.callback===null||typeof i.callback=="undefined"):case typeof i=="string"&&i.isEmpty():o="callback";break;case i instanceof Object&&typeof i.callback!="undefined":o=i.callback;break;default:o="callback"}s.then(function(e){return typeof n=="function"&&n(e),e},function(e){return typeof r=="function"&&r(e),e});do u=_.genId().slice(0,10);while(typeof e.abaaso.callback[u]!="undefined");return t=t.replace(o+"=?",o+"="+p+".callback."+u),e.abaaso.callback[u]=function(t){clearTimeout(_.timer[u]),delete _.timer[u],delete e.abaaso.callback[u],s.resolve(t),a.destroy()},a=l("head")[0].create("script",{src:t,type:"text/javascript"}),_.defer(function(){try{s.reject(undefined)}catch(e){h(e,arguments,this)}},3e4,u),t},request:function(e,t,n,r,i,o,u){u=u||3e4;var a,f,l,c,p,d,g,y,b,w,E;if(/^(post|put)$/i.test(t)&&typeof i=="undefined")throw Error(x.error.invalidArguments);t=t.toLowerCase(),o=o instanceof Object?o:null,a=m.cors(e),f=m.ie&&m.version<10&&a?new XDomainRequest:new XMLHttpRequest,l=/^(post|put)$/i.test(t)&&typeof i!="undefined"?i:null,c=t==="get"?v.get(e):!1,p=t.capitalize(),g=null,y=typeof Document!="undefined",b=typeof ArrayBuffer!="undefined",w=typeof Blob!="undefined",E=L.factory(),E.then(function(r){return t==="delete"&&v.expire(e),typeof n=="function"&&n.call(e,r,f),r},function(t){return typeof r=="function"&&r.call(e,t,f),t}),e.fire("before"+p);if(!/^(head|options)$/.test(t)&&e.allows(t)===!1)return f.status=405,E.reject(null),e.fire("failed"+p,null,f);if(t==="get"&&Boolean(c))s&&(f.readyState=4,f.status=200,f._resheaders=c.headers),E.resolve(c.response),e.fire("afterGet",c.response,f),f=null;else{f[f instanceof XMLHttpRequest?"onreadystatechange":"onload"]=function(n){m.response(f,e,t,E)};try{typeof f.timeout!="undefined"&&(f.timeout=u)}catch(T){void 0}typeof f.onerror!="undefined"&&(f.onerror=function(t){E.reject(t),e.fire("failed"+p,t,f)}),typeof f.ontimeout!="undefined"&&(f.ontimeout=function(t){E.reject(t),e.fire("timeout"+p,t,f)}),typeof f.onprogress!="undefined"&&(f.onprogress=function(t){e.fire("progress"+p,t,f)}),typeof f.upload!="undefined"&&typeof f.upload.onprogress!="undefined"&&(f.upload.onprogress=function(t){e.fire("progressUpload"+p,t,f)});try{f.open(t.toUpperCase(),e,!0),o!==null&&o.hasOwnProperty("Content-Type")&&(g=o["Content-Type"]),a&&g===null&&(g="text/plain"),l!==null&&(l.hasOwnProperty("xml")&&(l=l.xml),y&&l instanceof Document&&(l=H.decode(l)),typeof l=="string"&&/<[^>]+>[^<]*]+>/.test(l)&&(g="application/xml"),!(b&&l instanceof ArrayBuffer)&&!(w&&l instanceof Blob)&&l instanceof Object&&(g="application/json",l=S.encode(l)),g===null&&(b&&l instanceof ArrayBuffer||w&&l instanceof Blob)&&(g="application/octet-stream"),g===null&&(g="application/x-www-form-urlencoded; charset=UTF-8")),typeof f.setRequestHeader!="undefined"&&(typeof c=="object"&&c.headers.hasOwnProperty("ETag")&&f.setRequestHeader("ETag",c.headers.ETag),o===null&&(o={}),g!==null&&(o["Content-Type"]=g),o.hasOwnProperty("callback")&&delete o.callback,_.iterate(o,function(e,t){e!==null&&t!=="withCredentials"&&f.setRequestHeader(t,e)})),typeof f.withCredentials=="boolean"&&o!==null&&typeof o.withCredentials=="boolean"&&(f.withCredentials=o.withCredentials),l!==null?f.send(l):f.send()}catch(T){h(T,arguments,this,!0),E.reject(T),e.fire("failed"+p,m.parse(f),f)}}return e},response:function(e,t,r,i){var u=r.toLowerCase().capitalize(),a=n,f=null,l=m.ie&&typeof e.readyState=="undefined",c,p,d,g,y,b;c=function(e,n){i.reject(e),h(e,arguments,this,!0),t.fire("failed"+u,m.parse(n),n)};if(!l&&e.readyState===2)t.fire("received"+u,null,e);else if(!l&&e.readyState===4){switch(e.status){case 200:case 201:case 202:case 203:case 204:case 205:case 206:case 301:p=o.state,d=m.headers(e,t,r);if(r==="head")return i.resolve(d.headers),e.onreadystatechange=null,e=null,t.fire("afterHead",d.headers);if(r==="options")return i.resolve(d.headers),e.onreadystatechange=null,e=null,t.fire("afterOptions",d.headers);if(r!=="delete"&&/200|201/.test(e.status)){y=typeof d.headers["Content-Type"]!="undefined"?d.headers["Content-Type"]:"",g=m.parse(e,y);if(typeof g=="undefined")throw Error(x.error.serverError);v.set(t,"response",d.response=_.clone(g))}p.header!==null&&Boolean(f=d.headers[p.header])&&p.current!==f&&(typeof p.change=="function"?p.change(f):p.current=f),t.fire("headers",d.headers,e);switch(e.status){case 200:case 201:i.resolve(g),t.fire("after"+u,g,e);break;case 202:case 203:case 204:case 206:i.resolve(null),t.fire("after"+u,null,e);break;case 205:i.resolve(null),t.fire("reset",null,e);break;case 301:i.resolve(g),t.fire("moved",g,e)}break;case 401:c(s?x.error.serverUnauthorized:Error(x.error.serverUnauthorized),e);break;case 403:v.set(t,"!permission",m.bit([r])),c(s?x.error.serverForbidden:Error(x.error.serverForbidden),e);break;case 405:v.set(t,"!permission",m.bit([r])),c(s?x.error.serverInvalidMethod:Error(x.error.serverInvalidMethod),e);break;default:c(s?x.error.serverError:Error(x.error.serverError),e)}e.onreadystatechange=null,e=null}else l&&(Boolean(b=S.decode(/[\{\[].*[\}\]]/.exec(e.responseText)))?g=b:/<[^>]+>[^<]*]+>/.test(e.responseText)?g=H.decode(e.responseText):g=e.responseText,v.set(t,"permission",m.bit(["get"])),v.set(t,"response",g),i.resolve(g),t.fire("afterGet",g,e),e.onload=null,e=null);return t},size:function(){var e=s?{clientHeight:0,clientWidth:0}:typeof t.documentElement!="undefined"?t.documentElement:t.body;return{height:e.clientHeight,width:e.clientWidth}}},g={expire:function(e,t,n){return typeof g.get(e)!="undefined"&&g.set(e,"","-1s",t,n),e},get:function(e){return _.coerce(g.list()[e])},list:function(){var e={},n,r;return typeof t.cookie!="undefined"&&!t.cookie.isEmpty()&&(r=t.cookie.explode(";"),d.each(r,function(t){n=t.explode("="),e[decodeURIComponent(n[0].toString().trim())]=decodeURIComponent(n[1].toString().trim())})),e},set:function(e,n,r,i,s){typeof n=="undefined"&&(n=""),n+=";",typeof r=="undefined"&&(r=""),i=typeof i=="string"?" domain="+i+";":"",s=s===!0?"; secure":"";var o="",u=null,a=null,f=["d","h","m","s"],l=new RegExp,c=f.length;if(!r.isEmpty()){while(c--){_.compile(l,f[c]);if(l.test(r)){a=f[c],u=parseInt(r);break}}if(isNaN(u))throw Error(x.error.invalidArguments);o=new Date;switch(a){case"d":o.setDate(o.getDate()+u);break;case"h":o.setHours(o.getHours()+u);break;case"m":o.setMinutes(o.getMinutes()+u);break;case"s":o.setSeconds(o.getSeconds()+u)}}return o instanceof Date&&(o=" expires="+o.toUTCString()+";"),t.cookie=e.toString().trim()+"="+n+o+i+" path=/"+s,g.get(e)}},y={methods:{batch:function(e,t,n,r,i){e=e.toString().toLowerCase(),n=n===!0,r=r||1e3;if(!/^(set|del|delete)$/.test(e)||n&&/^del/.test(e)||typeof t!="object")throw Error(x.error.invalidArguments);var s=this.parentNode,o=this,u=0,a=t.length,f=!1,l=_.genId(!0),c=/^\/[^\/]/,h=L.factory(),p,v,m,g,y,b,w;return h.then(function(t){return/^del/.test(e)&&o.reindex(),o.loaded=!0,s.fire("afterDataBatch",t),i instanceof A&&i.resolve(t),t},function(e){return s.fire("failedDataBatch",e),i instanceof A&&i.reject(e),e}),p=function(e){h.resolve(e)},v=function(e){h.reject(e)},g=function(e,t){var r=L.factory(),i=_.genId(),s={};typeof s.batch!="function"?s=_.clone(e):_.iterate(e,function(e,t){o.collections.contains(t)||(s[t]=_.clone(e))}),o.key!==null&&typeof s[o.key]!="undefined"&&(t=s[o.key],delete s[o.key]),r.then(function(e){return++u===a&&p(o.get()),e},function(e){return f||(f=!0,v(e)),e}),s instanceof Array&&o.uri!==null?o.generate(t,undefined,r):o.set(t,s,n,r)},y=function(e){var t=L.factory();t.then(function(e){return++u===a&&p(e),e},function(e){return f||(f=!0,v(e)),e}),o.del(e,!1,n,t)},s.fire("beforeDataBatch",t),n&&this.clear(n),t.length===0?p(!1):e==="set"?d.each(t.chunk(r),function(e,t){var n=t*r;_.defer(function(){d.each(e,function(e,t){t=(n+t).toString();if(typeof e=="object")g(e,t);else if(e.indexOf("//")===-1){e.charAt(0)!=="/"?e=o.uri+"/"+e:o.uri!==null&&c.test(e)&&(w=_.parse(o.uri),e=w.protocol+"//"+w.host+e),t=e.replace(/.*\//,"");if(t.isEmpty())return;e.get(function(e){g(o.source===null?e:_.walk(e,o.source),t)},v,_.merge({withCredentials:o.credentials},o.headers))}else{t=e.replace(/.*\//,"");if(t.isEmpty())return;e.get(function(e){g(o.source===null?e:_.walk(e,o.source),t)},v,_.merge({withCredentials:o.credentials},o.headers))}})})}):d.each(t.sort(d.sort).reverse(),function(e){y(e)}),this},clear:function(e,t){e=e===!0;var n=this.parentNode;return e?(this.collections=[],this.crawled=!1,this.keys={},this.loaded=!1,this.records=[],this.total=0,this.views={}):(n.fire("beforeDataClear"),this.callback=null,this.collections=[],this.crawled=!1,this.credentials=null,this.expires=null,this.headers={Accept:"application/json"},this.ignore=[],this.key=null,this.keys={},this.leafs=[],this.loaded=!1,this.pointer=null,this.records=[],this.recursive=!1,this.retrieve=!1,this.source=null,this.total=0,this.views={},this.uri=null,n.fire("afterDataClear")),t instanceof A&&t.resolve(!0),this},crawl:function(e,t,n,r){var i=!1,s=this,o;if(typeof e!="number"&&typeof e!="string")throw Error(x.error.invalidArguments);return this.crawled=!0,this.loaded=!1,o=this.get(e),o=this.records[this.keys[o.key]],n=n||this.key,typeof t=="string"&&(i=!0,t=t.explode()),_.iterate(o.data,function(e,u){var a=L.factory();a.then(function(e){return this.fire("afterDataRetrieve",e),r instanceof A&&r.resolve(e),e},function(e){return this.fire("failedDataRetrieve",e),r instanceof A&&r.reject(e),e});if(i&&t.contains(u)||!(e instanceof Array)&&typeof e!="string")return;if(e instanceof Array)s.collections.contains(u)||s.collections.push(u),o.data[u]=y.factory({id:o.key+"-"+u},null,{key:n,pointer:s.pointer,source:s.source}),o.data[u].data.headers=_.merge(o.data[u].data.headers,s.headers),i&&d.each(t,function(e){o.data[u].data.ignore.add(e)}),d.each(s.leafs,function(e){o.data[u].data.leafs.add(e)}),!s.leafs.contains(u)&&s.recursive&&s.retrieve&&(o.data[u].data.recursive=!0,o.data[u].data.retrieve=!0),e.length>0&&o.data[u].data.batch("set",e,!0,a);else if(e.charAt(0)==="/"||e.indexOf("//")>-1)s.collections.contains(u)||s.collections.push(u),o.data[u]=y.factory({id:o.key+"-"+u},null,{key:n,pointer:s.pointer,source:s.source}),o.data[u].data.headers=_.merge(o.data[u].data.headers,s.headers),i&&d.each(t,function(e){o.data[u].data.ignore.add(e)}),d.each(s.leafs,function(e){o.data[u].data.leafs.add(e)}),!s.leafs.contains(u)&&s.recursive&&s.retrieve&&(o.data[u].data.recursive=!0,o.data[u].data.retrieve=!0),o.data[u].data.setUri(e,a)}),this.get(e)},del:function(e,t,n,r){if(typeof e=="undefined"||!/number|string/.test(typeof e))throw Error(x.error.invalidArguments);t=t!==!1,n=n===!0;var i=this.parentNode,s=this,o=/true|undefined/,u=L.factory(),a,f,l,c;u.then(function(e){var t=s.get(e.record);return s.records.remove(s.keys[e.key]),delete s.keys[e.key],s.total--,s.views={},e.reindex&&s.reindex(),_.iterate(t.data,function(e,t){if(e===null)return;typeof e.data!="undefined"&&typeof e.data.teardown=="function"&&e.data.teardown()}),i.fire("afterDataDelete",t),r instanceof A&&r.resolve(e),e},function(e){return i.fire("failedDataDelete",f),r instanceof A&&r.reject(e),e});if(typeof e=="string"){a=e,e=this.keys[a];if(typeof e=="undefined")throw Error(x.error.invalidArguments)}else{a=this.records[e];if(typeof a=="undefined")throw Error(x.error.invalidArguments);a=a.key}return f={key:a,record:e,reindex:t},!n&&this.callback===null&&this.uri!==null&&(l=this.uri+"/"+a,c=l.allows("delete")),i.fire("beforeDataDelete",f),n||this.callback!==null||this.uri===null?u.resolve(f):o.test(c)?l.del(function(e){u.resolve(f)},function(e){u.reject(f)},_.merge({withCredentials:this.credentials},this.headers)):u.reject(f),this},find:function(e,t,n){if(typeof e=="undefined")throw Error(x.error.invalidArguments);var r=[],i=[],s=new RegExp,o=typeof e=="function";return this.total===0?r:(o||(e=typeof e=="string"?e.explode():[e],typeof n=="undefined"||String(n).isEmpty()?n="gi":n===null&&(n="")),t=typeof t=="string"?t.explode():null,t===null?d.each(this.records,function(t){o?e(t)===!0&&(i.push(t.key),r.add(t)):_.iterate(t.data,function(o,u){if(i.contains(t.key))return!1;if(o===null||typeof o.data=="object")return;d.each(e,function(e){_.compile(s,e,n);if(s.test(String(o).escape()))return i.push(t.key),r.add(t),!1})})}):d.each(this.records,function(u){d.each(t,function(t){if(i.contains(u.key))return!1;if(typeof u.data[t]=="undefined"||typeof u.data[t].data=="object")return;if(!o)d.each(e,function(e){_.compile(s,e,n);if(s.test(String(u.data[t]).escape()))return i.push(u.key),r.add(u),!1});else if(e(u.data[t])===!0)return i.push(u.key),r.add(u),!1})}),r)},form:function(e,t,n){n=n!==!1;var r=e===null,i=this,s,o,u,a,f,c;r?e=this.get(0):e instanceof Object||(e=this.get(e));if(typeof e=="undefined")throw Error(x.error.invalidArguments);if(this.uri!==null&&!this.uri.allows("post"))throw Error(x.error.serverInvalidMethod);return f=e.key,c=e.data,typeof t!="undefined"&&(t=_.object(t)),this.uri!==null?(s=this.uri.replace(/.*\//,"").replace(/\?.*/,""),s.isDomain()&&(s=s.replace(/\..*/g,""))):s="record",u=function(e){var t=e.srcElement.parentNode,r=l("#"+t.id+" input"),s=r[0].name.match(/(.*)\[/)[1],o=!0,u={},a;i.parentNode.fire("beforeDataFormSubmit"),n&&(o=t.validate());switch(o){case!1:i.parentNode.fire("failedDataFormSubmit");break;case!0:d.each(r,function(e){if(typeof e.type!="undefined"&&/button|submit|reset/.test(e.type))return;_.define(e.name.replace("[",".").replace("]",""),e.value,u)}),a=_.genId(!0),i.parentNode.once("afterDataSet",function(){t.destroy()}),i.set(f,u[s])}i.parentNode.fire("afterDataFormSubmit",f)},a=function(e,t,n){var i,s;_.iterate(e,function(e,o){e instanceof Array?(i=0,d.each(e,function(e){a(e,t,n+"["+o+"]["+i++ +"]")})):e instanceof Object?a(e,t,n+"["+o+"]"):(s=(n+"["+o+"]").replace(/\[|\]/g,""),t.create("label",{"for":s}).html(o.capitalize()),t.create("input",{id:s,name:n+"["+o+"]",type:"text",value:r?"":e}))})},this.parentNode.fire("beforeDataForm"),o=w.create("form",{style:"display:none;"},t),a(c,o,s),o.create("input",{type:"button",value:x.common.submit}).on("click",function(e){u(e)}),o.create("input",{type:"reset",value:x.common.reset}),o.css("display","inherit"),this.parentNode.fire("afterDataForm",o),o},generate:function(e,t,n){var r=L.factory(),i={},s;return i={headers:this.headers,ignore:d.clone(this.ignore),leafs:d.clone(this.leafs),key:this.key,pointer:this.pointer,recursive:this.recursive,retrieve:this.retrieve,source:this.source},r.then(function(e){return n instanceof A&&n.resolve(e),e},function(e){return n instanceof A&&n.reject(e),e}),typeof this.keys[e]!="undefined"?(s=this.keys[e],typeof this.records[s].data.teardown=="function"&&this.records[s].data.teardown()):(this.set(e,{},!0),s=this.keys[e],this.collections.add(e)),this.records[s]=y.factory({id:this.parentNode.id+"-"+e},null,i),this.uri!==null&&typeof t=="undefined"&&!this.leafs.contains(e)&&(t=this.uri+"/"+e),typeof t!="undefined"?this.records[s].data.setUri(t,r):r.resolve(this.records[s].data.get()),this.records[s].data},get:function(e,t){var n=this.records,r=this.parentNode,i=typeof e,s=this,o;return i==="undefined"||String(e).length===0?o=n:i==="string"&&e.indexOf(",")>-1?(o=[],d.each(e.explode(),function(e){isNaN(e)||(e=parseInt(e)),o.push(s.get(e))})):i==="string"&&typeof this.keys[e]!="undefined"?o=n[this.keys[e]]:i==="number"&&typeof t=="undefined"?o=n[parseInt(e)]:i==="number"&&typeof t=="number"?o=n.limit(parseInt(e),parseInt(t)):o=undefined,o},record:function(e,t){return y.record.factory.call(this,e,t)},reindex:function(){var e=this.total,t=this.parentNode,n=this.key!==null,r=-1;this.views={};if(e>0)while(++r<e)!n&&this.records[r].key.isNumber()&&(delete this.keys[this.records[r].key],this.records[r].key=r.toString()),this.keys[this.records[r].key]=r;return this},set:function(e,t,n,r){e===null&&(e=undefined),n=n===!0;if((typeof e=="undefined"||String(e).isEmpty())&&this.uri===null||typeof t=="undefined")throw Error(x.error.invalidArguments);if(t instanceof Array)return this.generate(e).batch("set",t,!0,r);if(t instanceof Number||t instanceof String||typeof t!="object")throw Error(x.error.invalidArguments);var i=typeof e=="undefined"?undefined:this.get(e),s=this.parentNode,o=typeof e=="undefined"?"post":"put",u=this,a={data:{},key:e,record:undefined},f=this.uri,l=/true|undefined/,c=L.factory(),h;return typeof i!="undefined"?(a.record=this.records[this.keys[i.key]],_.iterate(a.record.data,function(e,t){!u.collections.contains(t)&&!u.ignore.contains(t)&&(a.data[t]=e)}),_.merge(a.data,t)):a.data=t,c.then(function(e){var t=typeof e.record=="undefined"?_.clone(e):e,n=!0,i=L.factory(),s,o;i.then(function(e){return n&&u.parentNode.fire("afterDataSet",e),r instanceof A&&r.resolve(e),e},function(e){throw u.fire("failedDataSet"),r instanceof A&&r.reject(e),Error(e)}),u.views={};if(typeof t.record=="undefined"){var a=u.total++;typeof t.key=="undefined"&&(typeof t.result=="undefined"&&(u.total--,i.reject(x.error.expectedObject)),u.source!==null&&(t.result=_.walk(t.result,u.source)),u.key===null?t.key=d.cast(t.result).first():(t.key=t.result[u.key],delete t.result[u.key]),typeof t.key!="string"&&(t.key=t.key.toString()),t.data=t.result),u.keys[t.key]=a,u.records[a]=u.record(t.key,{}),s=u.records[a];if(u.pointer===null||typeof t.data[u.pointer]=="undefined")s.data=t.data,u.key!==null&&u.records[a].data.hasOwnProperty(u.key)&&delete u.records[a].data[u.key];else{n=!1,o=t.data[u.pointer];if(typeof o=="undefined"||o===null)delete u.records[a],delete u.keys[t.key],i.reject(x.error.expectedObject);s.data={},o.get(function(e){u.source!==null&&(e=_.walk(e,u.source)),typeof e[u.key]!="undefined"&&delete e[u.key],_.merge(s.data,e),u.retrieve&&(u.crawl(s.key,u.ignore.length>0?u.ignore.join(","):undefined,u.key),u.loaded=!0),i.resolve(s)},function(e){i.reject(e)},u.headers)}}else s=u.records[u.keys[t.record.key]],_.merge(s.data,t.data);return u.retrieve&&u.crawl(s.key,u.ignore.length>0?u.ignore.join(","):undefined,u.key),i.resolve(s),e},function(e){return s.fire("failedDataSet",e),r instanceof A&&r.reject(e),e}),!n&&this.callback===null&&f!==null&&(typeof i!="undefined"&&(f+="/"+i.key),h=f.allows(o)),s.fire("beforeDataSet",{key:e,data:t}),n||this.callback!==null||this.uri===null?c.resolve(a):l.test(h)?f[o](function(e){a.result=e,c.resolve(a)},function(e){c.reject(e)},t,_.merge({withCredentials:this.credentials},this.headers)):c.reject(a),this},setExpires:function(e){if(e!==null&&this.uri===null||e!==null&&(isNaN(e)||e<1e3))throw Error(x.error.invalidArguments);if(this.expires===e)return;this.expires=e;var t=this.parentNode.id+"DataExpire",n=e,r=this;_.clearTimers(t);if(e===null)return;_.repeat(function(){if(r.uri===null)return r.setExpires(null),!1;v.expire(r.uri)||r.uri.fire("beforeExpire, expire, afterExpire")},n,t,!1)},setUri:function(e,t){var n;if(e!==null&&e.isEmpty())throw Error(x.error.invalidArguments);return this.uri===e?n=this.uri:(this.uri!==null&&this.uri.un(),n=this.uri=e,n!==null&&(n.on("expire",function(){this.sync(!0)},"dataSync",this),v.expire(n,!0),this.sync(!0,t))),n},sort:function(e,t,n){if(typeof e=="undefined"||String(e).isEmpty())throw Error(x.error.invalidArguments);/ci|cs|ms/.test(n)||(n="ci"),t=t===!0;var r=e.replace(/\s*asc/g,"").replace(/,/g," ").toCamelCase()+n.toUpperCase(),i=e.explode(),s=/:::(.*)$/,o=/\s*asc$/i,u=/\s*desc$/i,a=/^null/,f=this.key,l=[],c,h,p;return d.each(i,function(e){if(String(e).isEmpty())throw Error(x.error.invalidArguments)}),!t&&this.views[r]instanceof Array?this.views[r]:this.total===0?[]:(p=function(e,t){var n=e.clone(),r=e.first(),i={},s=[];return n.remove(0),i=c(r,t,u.test(r)),d.each(i.order,function(e){if(i.registry[e].length<2)return;n.length>0&&(i.registry[e]=p(n,i.registry[e]))}),d.each(i.order,function(e){s=s.concat(i.registry[e])}),s},c=function(e,t,r){e=e.replace(o,"");var i=e.replace(u,""),s=f===i,a=[],l={};return d.each(t,function(e){var t=s?e.key:e.data[i],r=t===null?"null":String(t);switch(n){case"ci":r=r.toCamelCase();break;case"cs":r=r.trim();break;case"ms":r=r.trim().slice(0,1).toLowerCase()}l[r]instanceof Array||(l[r]=[],a.push(r)),l[r].push(e)}),a.sort(d.sort),r&&a.reverse(),d.each(a,function(t){if(l[t].length===1)return;l[t]=h(l[t],e,i,r,s)}),{order:a,registry:l}},h=function(e,t,n,r,i){var o=[],u=[];return d.each(e,function(e,t){var r=i?e.key:e.data[n];r=String(r).trim()+":::"+t,o.push(r.replace(a,'""'))}),o.length>1&&(o.sort(d.sort),r&&o.reverse()),d.each(o,function(t){u.push(e[s.exec(t)[1]])}),u},l=p(i,this.records),this.views[r]=l,l)},storage:function(e,t,n){var r=!1,i=this,s=n==="session"&&typeof sessionStorage!="undefined",o=/number|string/,u,a,f;if(!/number|object|string/.test(typeof e)||!/get|remove|set/.test(t))throw Error(x.error.invalidArguments);r=o.test(e)||e.hasOwnProperty("key")&&!e.hasOwnProperty("parentNode"),r&&!(e instanceof Object)&&(e=this.get(e)),a=r?e.key:e.parentNode.id;switch(t){case"get":u=s?sessionStorage.getItem(a):localStorage.getItem(a);if(u===null)throw Error(x.error.invalidArguments);u=S.decode(u),r?this.set(a,u,!0):(_.merge(this,u),d.each(i.records,function(e,t){i.records[t]=i.record(e.key,e.data)})),u=r?e:this;break;case"remove":s?sessionStorage.removeItem(a):localStorage.removeItem(a),u=this;break;case"set":f=S.encode(r?e.data:{total:this.total,keys:this.keys,records:this.records}),s?sessionStorage.setItem(a,f):localStorage.setItem(a,f),u=this}return u},sync:function(e,t){if(this.uri===null||this.uri.isEmpty())throw Error(x.error.invalidArguments);e=e===!0;var n=this,r=n.parentNode,i=_.guid(!0),s=L.factory(),o,u;return s.then(function(i){if(typeof i!="object")throw Error(x.error.expectedObject);var s=!1,o=L.factory(),u;return n.source!==null&&(i=_.walk(i,n.source)),i instanceof Array?u=i:_.iterate(i,function(e){!s&&e instanceof Array&&(s=!0,u=e)}),typeof u=="undefined"&&(u=[i]),o.then(function(i){var s=[];return e&&n.reindex(),r.fire("afterDataSync",i),t instanceof A&&t.resolve(i),s},function(e){return n.clear(!0),r.fire("failedDataSync",e),t instanceof A&&t.reject(e),e}),n.batch("set",u,!0,1e3,o),i},function(e){return r.fire("failedDataSync",e),t instanceof A&&t.reject(e),e}),o=function(e){s.resolve(e)},u=function(e){s.reject(e)},r.fire("beforeDataSync"),this.callback!==null?m.jsonp(this.uri,o,u,{callback:this.callback}):m.request(this.uri,"GET",o,u,_.merge({withCredentials:this.credentials},this.headers)),this},teardown:function(){var e=this.uri,t,n;return e!==null&&(v.expire(e,!0),k.remove(e),n=this.parentNode.id+"DataExpire",_.clearTimers(n),t=this.get(),d.each(t,function(t){v.expire(e+"/"+t.key,!0),k.remove(e+"/"+t.key),_.iterate(t.data,function(e,t){if(e===null)return;e.hasOwnProperty("data")&&typeof e.data.teardown=="function"&&(k.remove(e.id),e.data.teardown())})})),this.clear(!0),this.parentNode.fire("afterDataTeardown"),this}},record:{methods:{del:function(e){return this.parentNode.del(this.key,!0,!1,e)},set:function(e,t,n){return this.parentNode.set(this.key,{key:t},!1,n),this}},factory:function(e,t){return _.extend(y.record.methods,{key:e,data:t})}},factory:function(e,t,n){return e=_.object(e),_.genId(e),typeof e.fire=="undefined"&&k.hook(e),e.fire("beforeDataStore"),e.data=_.extend(y.methods),e.data.parentNode=e,e.data.clear(),n instanceof Object&&_.merge(e.data,n),typeof t=="object"&&t!==null&&e.data.batch("set",t),e.fire("afterDataStore"),e}},b={position:/top|bottom/,methods:{page:function(e){if(isNaN(e))throw Error(x.error.invalidArguments);return this.pageIndex=e,this.refresh(),this},pages:function(){var e=this.element,t=l("#"+e.id+"-pages-top, #"+e.id+"-pages-bottom"),n=this.pageIndex,r=this.pagination,i=this.pageRange,s=C.round(C.half(i),"down"),o=n-s,u=n+s,a=this,f=b.pages.call(this),c=0,h,p,v;if(!b.position.test(r))throw Error(x.error.invalidArguments);return d.each(t,function(e){typeof e!="undefined"&&e.destroy()}),this.total===0||f===1?this:(o<1&&(h=o.diff(1),o+=h,u+=h),u>f&&(u=f,o=u-i+1,o<1&&(o=1)),d.each(r.explode(),function(r){t=e[r==="bottom"?"after":"before"]("ul",{"class":"list pages "+r,id:e.id+"-pages-"+r}),n>1?t.create("li").create("a",{"class":"first page","data-page":1}).html("&lt;&lt;").on("click",function(){a.page(this.data("page"))},"click"):t.create("li").create("span",{"class":"first page"}).html("&lt;&lt;"),n>1?t.create("li").create("a",{"class":"prev page","data-page":n-1}).html("&lt;").on("click",function(){a.page(this.data("page"))},"click"):t.create("li").create("span",{"class":"prev page"}).html("&lt;");for(r=o;r<=u;r++)r!==n?t.create("li").create("a",{"class":r===n?"current page":"page","data-page":r}).html(r).on("click",function(e){a.page(this.data("page"))},"click"):t.create("li").create("span",{"class":"page"}).html(r);n+1<=f?t.create("li").create("a",{"class":"next page","data-page":n+1}).html("&gt;").on("click",function(){a.page(this.data("page"))},"click"):t.create("li").create("span",{"class":"next page"}).html("&gt;"),n<f?t.create("li").create("a",{"class":"last page","data-page":f}).html("&gt;&gt;").on("click",function(){a.page(this.data("page"))},"click"):t.create("li").create("span",{"class":"last page"}).html("&gt;&gt;"),t.find("a").on("click",function(e){window.scrollTo(0,0)})}),this)},refresh:function(e){e=e!==!1;var t=this.element,n=typeof this.template=="object",r=!n&&String(this.template).replace(/\{\{|\}\}/g,"")===this.store.key,i=[],s=[],o=this,u=typeof this.callback=="function",a=/\{\{.*\}\}/g,f=new RegExp,c=[],h=[],p,v,m;this.ready||(this.ready=!0,this.store.parentNode.on("afterDataSet",function(e){if(b.garbage(this.store.parentNode,t.id,"afterDataSet","set-"+t.id))return;this.refreshing||this.refresh()},"set-"+t.id,this)),this.element.fire("beforeDataListRefresh"),this.refreshing=!0,n?p=function(e){var t=S.encode(o.template);return t=t.replace("{{"+o.store.key+"}}",e.key),S.iterate(e.data,function(e,n){f.compile("{{"+n+"}}","g"),t=t.replace(f,S.encode(e).replace(/(^")|("$)/g,""))}),t=S.decode(t.replace(a,o.placeholder)),{li:t}}:p=function(e){var t=String(o.template);return t=t.replace("{{"+o.store.key+"}}",e.key),_.iterate(e.data,function(e,n){f.compile("{{"+n+"}}","g"),t=t.replace(f,e)}),{li:t.replace(a,o.placeholder)}},i=this.order.isEmpty()?this.store.get():this.store.sort(this.order,!1,this.sensitivity),d.each(i,function(e){o.filter!==null&&o.filter instanceof Object?_.iterate(o.filter,function(t,n){if(c.index(e.key)>-1)return;var r=0,i=new RegExp,u;t=String(t).explode(),u=t.length;for(r=0;r<u;r++){i.compile(t[r],"i");if(n===o.store.key&&i.test(e.key)||typeof e.data[n]!="undefined"&&i.test(e.data[n])){c.push(e.key),s.push({key:e.key,template:p(e)});return}}}):s.push({key:e.key,template:p(e)})}),this.total=s.length;if(typeof this.pageIndex=="number"&&typeof this.pageSize=="number"){m=b.pages.call(this);if(this.pageIndex>m)return this.page(m);h=b.range.call(this),s=s.limit(h[0],h[1])}return e?(t.clear(),d.each(s,function(e){var n=t.tpl(e.template);n.data("key",e.key),u&&o.callback(n)})):(t.find("> li").addClass("hidden"),d.each(s,function(e){t.find("> li[data-key='"+e.key+"']").removeClass("hidden")})),b.position.test(this.pagination)&&typeof this.pageIndex=="number"&&typeof this.pageSize=="number"?this.pages():(l("#"+this.element.id+"-pages-top, #"+this.element.id+"-pages-bottom"),typeof v!="undefined"&&v.destroy()),this.refreshing=!1,this.element.fire("afterDataListRefresh",t),this},sort:function(e,t){if(typeof e!="string")throw Error(x.error.invalidArguments);return this.element.fire("beforeDataListSort"),this.order=e,this.sensitivity=t||"ci",this.refresh(),this.element.fire("afterDataListSort"),this},teardown:function(){var e=this.element.id;return this.store.parentNode.un("afterDataDelete","delete-"+e,"afterDataRetrieve, afterDataSync","refresh-"+e),this}},factory:function(e,t,n,r){var i=[t],s={},o={},u,a;if(e instanceof Element&&typeof t=="object"&&!!/string|object/.test(typeof n))return u=e.fire("beforeDataList").create("ul",{"class":"list",id:t.parentNode.id+"-datalist"}),o={callback:null,filter:null,pageIndex:1,pageSize:null,pageRange:5,pagination:"bottom",placeholder:"",order:"",ready:!1,refreshing:!1,template:n,total:0,sensitivity:"ci"},s=_.extend(b.methods,o),s.element=u,s.store=i[0],r instanceof Object&&_.iterate(r,function(e,t){s[t]=e}),s.store.parentNode.on("afterDataDelete",function(e){if(b.garbage(this.store.parentNode,u.id,"afterDataDelete","delete-"+u.id))return;typeof this.pageIndex=="number"&&typeof this.pageSize=="number"?this.refresh():(this.element.fire("beforeDataListRefresh"),this.element.find("> li[data-key='"+e.key+"']").destroy(),this.element.fire("afterDataListRefresh"))},"delete-"+u.id,s),a=function(){var e=this.store.retrieve?"afterDataRetrieve":"afterDataSync";this.store.parentNode.once(e,function(){if(b.garbage(this.store.parentNode,u.id,e,"refresh-"+u.id))return;!this.refreshing&&(e==="afterDataRetrieve"||this.store.loaded)&&this.refresh(),a.call(this)},"refresh-"+u.id,this),b.now.call(s)&&s.refresh()},b.now.call(s)?a.call(s):s.store.parentNode.once(s.store.parentNode.retrieve?"afterDataRetrieve":"afterDataSync",a,"initialize-"+u.id,s),e.fire("afterDataList",u),s;throw Error(x.error.invalidArguments)},garbage:function(e,t,n,r){var i=!1;return typeof l("#"+t)=="undefined"&&(e.un(n,r),i=!0),i},now:function(){return this.store.uri===null||this.store.loaded},pages:function(){if(isNaN(this.pageSize))throw Error(x.error.invalidArguments);return C.round(this.total/this.pageSize,"up")},range:function(){var e=this.pageIndex*this.pageSize-this.pageSize,t=this.pageSize;return[e,t]}},w={attr:function(e,t,n){typeof n=="string"&&(n=n.trim());var r=/checked|disabled/,i;e=_.object(e);if(e instanceof Element&&typeof t!="undefined"&&!String(t).isEmpty()){_.genId(e,!0);if(r.test(t)&&typeof n=="undefined")return e[t];if(r.test(t)&&typeof n!="undefined")e[t]=n;else{if(e.nodeName==="SELECT"&&t==="selected"&&typeof n=="undefined")return l("#"+e.id+' option[selected="selected"]').first()||l("#"+e.id+" option").first();if(e.nodeName==="SELECT"&&t==="selected"&&typeof n!="undefined")i=l("#"+e.id+' option[selected="selected"]').first(),typeof i!="undefined"&&(i.selected=!1,i.removeAttribute("selected")),i=l("#"+e.id+' option[value="'+n+'"]').first(),i.selected=!0,i.setAttribute("selected","selected");else{if(typeof n=="undefined")return e.getAttribute(t);n===null?e.removeAttribute(t):e.setAttribute(t,n)}}return e}throw Error(x.error.invalidArguments)},clear:function(e){e=_.object(e);if(e instanceof Element)return typeof e.reset=="function"?e.reset():typeof e.value!="undefined"?e.update({innerHTML:"",value:""}):e.update({innerHTML:""}),e;throw Error(x.error.invalidArguments)},create:function(e,n,r,i){if(typeof e=="undefined"||String(e).isEmpty())throw Error(x.error.invalidArguments);var s,u,a;typeof r!="undefined"?r=_.object(r):typeof n=="undefined"||typeof n!="string"&&typeof n.childNodes=="undefined"?r=t.body:r=_.object(n);if(typeof r=="undefined")throw Error(x.error.invalidArguments);return a=!(r instanceof Element),u=typeof n!="undefined"&&typeof n!="string"&&typeof n.childNodes=="undefined"&&typeof n.id!="undefined"&&typeof l("#"+n.id)=="undefined"?n.id:_.genId(undefined,!0),typeof n!="undefined"&&typeof n.id!="undefined"&&delete n.id,k.fire(o,"beforeCreate",u),a&&r.parentNode!==null&&r.parentNode.fire("beforeCreate",u),s=/svg/i.test(e)?t.createElementNS("http://www.w3.org/2000/svg","svg"):t.createElement(e),s.id=u,typeof n=="object"&&typeof n.childNodes=="undefined"&&s.update(n),typeof i=="undefined"||i==="last"?r.appendChild(s):i==="first"?r.prependChild(s):i==="after"?(i={},i.after=r,r=r.parentNode,r.insertBefore(s,i.after.nextSibling)):typeof i.after!="undefined"?r.insertBefore(s,i.after.nextSibling):i==="before"?(i={},i.before=r,r=r.parentNode,r.insertBefore(s,i.before)):typeof i.before!="undefined"?r.insertBefore(s,i.before):r.appendChild(s),a?a&&r.parentNode!==null&&r.parentNode.fire("afterCreate",s):r.fire("afterCreate",s),k.fire(o,"afterCreate",s),s},css:function(e,t,n){e=_.object(e),t=t.indexOf("-")>-1?M.toCamelCase(t,!0):t;var r,i;return typeof n!="undefined"?(e.style[t]=n,i=e):i=e.style[t],i},data:function(e,t,n){var r;return e=_.object(e),typeof n!="undefined"?(typeof e.dataset=="object"?e.dataset[t]=n:w.attr(e,"data-"+t,n),r=e):r=_.coerce(typeof e.dataset=="object"?e.dataset[t]:w.attr(e,"data-"+t)),r},destroy:function(e){e=_.object(e);if(e instanceof Element)return k.fire(o,"beforeDestroy",e),k.remove(e.id),e.parentNode!==null&&e.parentNode.removeChild(e),k.fire(o,"afterDestroy",e.id),undefined;throw Error(x.error.invalidArguments)},disable:function(e){e=_.object(e);if(e instanceof Element)return typeof e.disabled=="boolean"&&!e.disabled&&(e.disabled=!0),e;throw Error(x.error.invalidArguments)},enable:function(e){e=_.object(e);if(e instanceof Element)return typeof e.disabled=="boolean"&&e.disabled&&(e.disabled=!1),e;throw Error(x.error.invalidArguments)},find:function(e,t){var n=[];e=_.object(e);if(e instanceof Element&&typeof t=="string")return _.genId(e,!0),d.each(t.explode(),function(t){n=n.concat(l("#"+e.id+" "+t))}),n;throw Error(x.error.invalidArguments)},has:function(e,t){var n=w.find(e,t);return!isNaN(n.length)&&n.length>0},hasClass:function(e,t){e=_.object(e);if(e instanceof Element)return e.classList.contains(t);throw Error(x.error.invalidArguments)},hide:function(e){e=_.object(e);if(e instanceof Element)return typeof e.hidden=="boolean"?e.hidden=!0:(e["data-display"]=e.style.display,e.style.display="none"),e;throw Error(x.error.invalidArguments)},hidden:function(e){e=_.object(e);if(e instanceof Element)return e.style.display==="none"||typeof e.hidden=="boolean"&&e.hidden;throw Error(x.error.invalidArguments)},is:function(e,t){e=_.object(e);if(e instanceof Element&&typeof t=="string")return/^:/.test(t)?d.contains(w.find(e.parentNode,e.nodeName.toLowerCase()+t),e):(new RegExp(t,"i")).test(e.nodeName);throw Error(x.error.invalidArguments)},klass:function(e,t,n){var r;e=_.object(e);if(e instanceof Element&&!String(t).isEmpty())return n=n!==!1,t=t.explode(" "),n?d.each(t,function(t){e.classList.add(t)}):d.each(t,function(t){if(t==="*")return d.each(e.classList,function(e){this.remove(e)}),!1;e.classList.remove(t)}),e;throw Error(x.error.invalidArguments)},position:function(n){n=_.object(n);if(n instanceof Element){var r,i,s,o;r=i=0,o=n.offsetWidth,s=n.offsetHeight;if(n.offsetParent){i=n.offsetTop,r=n.offsetLeft;while(n=n.offsetParent)r+=n.offsetLeft,i+=n.offsetTop}return{top:i,right:t.documentElement.clientWidth-(r+o),bottom:t.documentElement.clientHeight+e.scrollY-(i+s),left:r}}throw Error(x.error.invalidArguments)},prependChild:function(e,t){e=_.object(e);if(e instanceof Element&&t instanceof Element)return e.childNodes.length===0?e.appendChild(t):e.insertBefore(t,e.childNodes[0]);throw Error(x.error.invalidArguments)},serialize:function(e,t,n){e=_.object(e),t=t===!0,n=n!==!1;var r=[],i={},s;return e instanceof Array?d.each(e,function(e){r.push(_.object(e))}):r=e.nodeName==="FORM"?typeof e.elements!="undefined"?d.cast(e.elements):e.find("button, input, select, textarea"):[e],d.each(r,function(e){e.nodeName==="FORM"?_.merge(i,S.decode(w.serialize(e))):typeof i[e.name]=="undefined"&&(i[e.name]=w.val(e))}),t?(s="",_.iterate(i,function(e,t){n?s+="&"+encodeURIComponent(t)+"="+encodeURIComponent(e):s+="&"+t+"="+e,s=s.replace(/^&/,"?")})):s=S.encode(i),s},show:function(e){e=_.object(e);if(e instanceof Element)return typeof e.hidden=="boolean"?e.hidden=!1:e.style.display=e.getAttribute("data-display")!==null?e.getAttribute("data-display"):"inherit",e;throw Error(x.error.invalidArguments)},size:function(e){e=_.object(e);var t,n,r;if(e instanceof Element)return t=function(e){return isNaN(e)?0:parseInt(e)},n=e.offsetHeight+t(e.style.paddingTop)+t(e.style.paddingBottom)+t(e.style.borderTop)+t(e.style.borderBottom),r=e.offsetWidth+t(e.style.paddingLeft)+t(e.style.paddingRight)+t(e.style.borderLeft)+t(e.style.borderRight),{height:n,width:r};throw Error(x.error.invalidArguments)},text:function(e,t){e=_.object(e);var n=typeof e.textContent!="undefined"?"textContent":"innerText",r={},i=!1;return typeof t!="undefined"&&(i=!0,r[n]=t),i?w.update(e,r):e[n]},toggleClass:function(e,t){e=_.object(e);if(e instanceof Element)return e.classList.toggle(t),e;throw Error(x.error.invalidArguments)},update:function(e,t){var n;e=_.object(e),t=t||{};if(e instanceof Element)return n=/innerHTML|innerText|textContent|type|src/,_.iterate(t,function(t,r){if(n.test(r))e[r]=t;else if(r==="class")t.isEmpty()?e.removeClass("*"):e.addClass(t);else if(r.indexOf("data-")===0)w.data(e,r.replace("data-",""),t);else if(r==="id"){var i=k.listeners;typeof i[e.id]!="undefined"&&(i[r]=_.clone(i[e.id]),delete i[e.id])}else e.attr(r,t)}),e;throw Error(x.error.invalidArguments)},val:function(e,t){var n=null,r=/^select$/i,i=/^(radio|checkbox)$/i,s;e=_.object(e);if(e instanceof Element){if(typeof t=="undefined"){if(i.test(e.type)){if(e.name.isEmpty())throw Error(x.error.expectedProperty);s=l("input[name='"+e.name+"']"),d.each(s,function(e){if(n!==null)return;e.checked&&(n=e.value)})}else r.test(e.type)?n=e.options[e.selectedIndex].value:n=typeof e.value!="undefined"?e.value:w.text(e);typeof n=="string"&&(n=n.trim())}else t=String(t),e.fire("beforeValue"),i.test(e.type)?(s=l("input[name='"+e.name+"']"),d.each(s,function(e){if(e.value===t)return e.checked=!0,n=e,!1})):r.test(e.type)?d.each(w.find(e,"> *"),function(e){if(e.value===t)return e.selected=!0,n=e,!1}):typeof e.value!="undefined"?e.value=t:w.text(e,t),e.fire("afterValue"),n=e;return n}throw Error(x.error.invalidArguments)}},E={methods:{init:function(){return k.add(this.element,"keyup",this.update,"filter",this),k.add(this.element,"afterValue",this.update,"value",this),this},set:function(e){var t={};if(typeof e!="string"||String(e).isEmpty())throw Error(x.error.invalidArguments);return d.each(e.explode(),function(e){t[e]=""}),this.filters=t,this},teardown:function(){return k.remove(this.element,"keyup","filter"),k.remove(this.element,"afterValue","value"),this},update:function(e){var t=this.element.val();return t.isEmpty()?this.datalist.filter=null:(_.iterate(this.filters,function(e,n){this[n]="^"+t.escape().replace("\\*",".*")}),this.datalist.filter=this.filters),this.datalist.pageIndex=1,this.datalist.refresh(),this}},factory:function(e,t,n){var r={},i=[t];if(!(e instanceof Element)||typeof t!="undefined"&&typeof t.store=="undefined"||typeof n!="string"||String(n).isEmpty())throw Error(x.error.invalidArguments);return r=_.extend(E.methods,{filters:{}}),r.datalist=i[0],r.element=e,r.set(n),r.init()}},S={decode:function(e,t){try{return JSON.parse(e)}catch(n){return t!==!0&&h(n,arguments,this),undefined}},encode:function(e,t){try{return JSON.stringify(e)}catch(n){return t!==!0&&h(n,arguments,this),undefined}}},x={common:{back:"Back",cancel:"Cancel",clear:"Clear",close:"Close",cont:"Continue",create:"Create",del:"Delete",edit:"Edit",find:"Find",gen:"Generate",go:"Go",loading:"Loading",next:"Next",login:"Login",ran:"Random",reset:"Reset",save:"Save",search:"Search",submit:"Submit"},day:{0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},error:{databaseNotOpen:"Failed to open the Database, possibly exceeded Domain quota",databaseNotSupported:"Client does not support local database storage",databaseWarnInjection:"Possible SQL injection in database transaction, use the &#63; placeholder",elementNotCreated:"Could not create the Element",elementNotFound:"Could not find the Element",expectedArray:"Expected an Array",expectedArrayObject:"Expected an Array or Object",expectedBoolean:"Expected a Boolean value",expectedNumber:"Expected a Number",expectedProperty:"Expected a property, and it was not set",expectedObject:"Expected an Object",invalidArguments:"One or more arguments is invalid",invalidDate:"Invalid Date",invalidFields:"The following required fields are invalid: ",invalidRoute:"The route could not be found",notAvailable:"Requested method is not available",notSupported:"This feature is not supported by this platform",propertyNotFound:"Could not find the requested property",promisePending:"The promise cannot be resolved while pending result",promiseResolved:"The promise has been resolved: {{outcome}}",serverError:"Server error has occurred",serverForbidden:"Forbidden to access URI",serverInvalidMethod:"Method not allowed",serverUnauthorized:"Authorization required to access URI"},month:{0:"January",1:"February",2:"March",3:"April",4:"May",5:"June",6:"July",7:"August",8:"September",9:"October",10:"November",11:"December"}},T={clear:function(t){return typeof t=="undefined"&&(t="all"),k.remove(e,"message","message",t)},send:function(e,t){try{e.postMessage(t,"*")}catch(n){h(n,arguments,this)}return e},recv:function(t,n){return typeof n=="undefined"&&(n="all"),k.add(e,"message",t,"message",e,n)}},N={enabled:!1,log:!1,diff:{x:null,y:null},pos:{x:null,y:null},prev:{x:null,y:null},track:function(e){var n=o.mouse,e="mousemove",r="tracking";if(!s)if(typeof e=="object"){var i=t[m.ie&&m.version<9?"documentElement":"body"],u=e.pageX?e.pageX:i.scrollLeft+e.clientX,a=e.pageY?e.pageY:i.scrollTop+e.clientY,f=!1;n.pos.x!==u&&(f=!0),l.mouse.prev.x=n.prev.x=Number(n.pos.x),l.mouse.pos.x=n.pos.x=u,l.mouse.diff.x=n.diff.x=n.pos.x-n.prev.x,n.pos.y!==a&&(f=!0),l.mouse.prev.y=n.prev.y=Number(n.pos.y),l.mouse.pos.y=n.pos.y=a,l.mouse.diff.y=n.diff.y=n.pos.y-n.prev.y,f&&n.log&&_.log(n.pos.x+" ["+n.diff.x+"], "+n.pos.y+" ["+n.diff.y+"]")}else typeof e=="boolean"&&(e?k.add(t,e,o.mouse.track,r):k.remove(t,e,r),l.mouse.enabled=n.enabled=e);return n}},C={diff:function(e,t){if(isNaN(e)||isNaN(t))throw Error(x.error.expectedNumber);return Math.abs(e-t)},even:function(e){return e%2===0},format:function(e,t,n){if(isNaN(e))throw Error(x.error.expectedNumber);e=e.toString(),t=t||",",n=n||3;var r=e.indexOf(".")>-1?"."+e.replace(/.*\./,""):"",i=e.replace(/\..*/,"").split("").reverse(),s=Math.floor(i.length/n),o=1,u,a;for(a=0;a<s;a++)u=o===1?n:n*o+(o===2?1:o-1),i.splice(u,0,t),o++;return i=i.reverse().join(""),i.charAt(0)===t&&(i=i.substring(1)),i+r},half:function(e,t){return typeof t!="undefined"?e/t===.5:e/2},odd:function(e){return e%2!==0},parse:function(e,t){return t===null&&(t=undefined),isNaN(t)?Number(e):parseInt(e,t)},random:function(e){return e=e||100,Math.floor(Math.random()*(e+1))},round:function(e,t){return/down|up/.test(t)||(t="down"),Math[t==="down"?"floor":"ceil"](e)}},k={listeners:{},alisteners:{},elisteners:{},clisteners:{},log:!1,queue:[],silent:!1,ignore:!1,regex_globals:/body|document|window/i,regex_allowed:/click|error|key|mousedown|mouseup|submit/i,add:function(e,t,n,r,i,s){e=_.object(e),i=i||e,s=s||o.state.current;if(e instanceof Array)return d.each(e,function(e){k.add(e,t,n,r,i,s)});typeof t!="undefined"&&(t=t.explode());if(typeof r=="undefined"||!/\w/.test(r))r=_.guid(!0);var u=null,a=k.listeners,f=k.alisteners,l=k.elisteners,c=k.clisteners,h=k.regex_globals,p=k.regex_allowed,v=k.id(e),m=!1,g=o.state.current,y,b;if(typeof v=="undefined"||t===null||typeof t=="undefined"||typeof n!="function")throw Error(x.error.invalidArguments);return typeof a[v]=="undefined"&&(a[v]={},f[v]={},c[v]={}),d.each(t,function(t){var o=v+"_"+t;typeof a[v][t]=="undefined"&&(a[v][t]={},f[v][t]={},c[v][t]=0),typeof a[v][t][s]=="undefined"&&(a[v][t][s]={},f[v][t][s]=[]),u=h.test(v)||!/\//g.test(v)&&v!=="abaaso"?e:null,u!==null&&typeof u!="undefined"&&t.toLowerCase()!=="afterjsonp"&&typeof l[o]=="undefined"&&(h.test(v)||typeof u.listeners=="function")&&(y=typeof u.addEventListener=="function",b=typeof u.attachEvent=="object"||y,b&&(l[o]=function(n){p.test(n.type)||_.stop(n),k.fire(e,t,n)},u[y?"addEventListener":"attachEvent"]((y?"":"on")+t,l[o],!1))),a[v][t][s][r]={fn:n,scope:i},k.sync(v,t,s),c[v][t]++}),e},discard:function(e){return k.ignore=e,e},fire:function(e,t){e=_.object(e);var n=!1,r=d.cast(arguments).remove(0,1),s,r,u,a,f,c,h;if(k.ignore)return e;if(e instanceof Array)return r=[e[i],t].concat(r),d.each(e,function(e){k.fire.apply(k,r)});s=k.id(e);if(typeof s=="undefined"||typeof t=="undefined")throw Error(x.error.invalidArguments);return k.silent?k.queue.push({obj:e,event:t}):(u=o.state.current,a=l.logging||o.logging,d.each(t.explode(),function(t){a&&_.log(s+" firing "+t),h=k.list(e,t,k.alisteners),typeof h.all!="undefined"&&d.each(h.all,function(e){var t=e.fn.apply(e.scope,r);if(t===!1)return n=!0,t}),!n&&u!=="all"&&typeof h[u]!="undefined"&&d.each(h[u],function(e){return e.fn.apply(e.scope,r)})})),e},hook:function(e){return e.fire=function(){return k.fire.apply(k,[this].concat(d.cast(arguments)))},e.listeners=function(e){return k.list(this,e)},e.on=function(e,t,n,r,i){return k.add(this,e,t,n,r,i)},e.once=function(e,t,n,r,i){return k.once(this,e,t,n,r,i)},e.un=function(e,t){return k.remove(this,e,t)},e},id:function(n){var r;return n===o?r="abaaso":n===e?r="window":n===!s&&t?r="document":n===!s&&t.body?r="body":(_.genId(n),r=typeof n.id!="undefined"?n.id:typeof n.toString=="function"?n.toString():n),r},list:function(e,t,n){e=_.object(e);var r=n||k.listeners,i=k.id(e),s;return typeof r[i]=="undefined"&&typeof t=="undefined"?s={}:typeof r[i]=="undefined"||typeof t!="undefined"&&!String(t).isEmpty()?typeof r[i]!="undefined"&&typeof r[i][t]!="undefined"?s=r[i][t]:s={}:s=r[i],s},once:function(e,t,n,r,i,s){var u=r||_.genId();e=_.object(e),i=i||e,s=s||o.state.current;if(typeof e=="undefined"||t===null||typeof t=="undefined"||typeof n!="function")throw Error(x.error.invalidArguments);return e instanceof Array?d.each(e,function(e){k.once(e,t,n,r,i,s)}):(k.add(e,t,function(){n.apply(i,arguments),k.remove(e,t,u,s)},u,i,s),e)},pause:function(e){return e===!0?k.silent=e:e===!1&&(k.silent=e,d.each(k.queue,function(e){k.fire(e.obj,e.event)}),k.queue=[]),e},remove:function(e,t,n,r){e=_.object(e),r=r||o.state.current;if(e instanceof Array)return d.each(e,function(e){k.remove(e,t,n,r)});var i=null,s=k.listeners,u=k.alisteners,a=k.elisteners,f=k.clisteners,l=k.id(e),c,h,p;return h=function(t,n){var r=!1;c=typeof e.addEventListener=="function",p=typeof e.attachEvent=="object"||c,t===null?r=!0:typeof n=="number"&&(f[l][t]=f[l][t]-n)===0&&(r=!0),r&&p&&(e[c?"removeEventListener":"detachEvent"]((c?"":"on")+t,a[l+"_"+t],!1),delete a[l+"_"+t])},typeof l=="undefined"||typeof s[l]=="undefined"?e:(typeof t=="undefined"||t===null?(delete s[l],delete u[l],delete f[l],(k.regex_globals.test(l)||typeof l.listeners=="function")&&h(null)):d.each(t.explode(),function(t){var i=!1;if(typeof s[l][t]=="undefined")return e;typeof n=="undefined"?((k.regex_globals.test(l)||typeof l.listeners=="function")&&h(t,d.keys(s[l][t][r]).length),s[l][t][r]={},i=!0):typeof s[l][t][r][n]!="undefined"&&(h(t,1),delete s[l][t][r][n],i=!0),i&&k.sync(l,t,r)}),e)},sum:function(e){var t={},n;return typeof e!="undefined"?(e=_.object(e),n=k.id(e),t=_.clone(k.clisteners[n])):t=_.clone(k.clisteners),t},sync:function(e,t,n){k.alisteners[e][t][n]=d.cast(k.listeners[e][t][n])}},L={state:{broken:"failed",initial:"unfulfilled",pending:"pending",resolved:"fulfilled"},methods:{reject:function(e){return L.resolve.call(this,L.state.broken,e)},resolve:function(e){return L.resolve.call(this,L.state.resolved,e)},resolved:function(){return this.state===L.state.broken||this.state===L.state.resolved},then:function(e,t){var n=this,r=L.factory(),i;return i=function(i){var s=i?e:t,o,u;try{if(typeof s!="function")throw n.outcome;o=s(n.outcome),!(o instanceof A)&&!i&&r.state===L.state.initial&&r.fulfill.length>0&&(n.state=L.state.resolved)}catch(a){o=a.message||a,n.state=L.state.broken}finally{return o instanceof A?(n.state=L.state.pending,n.outcome=null,o.parentNode=n,o.then(function(e){n.state=L.state.initial,n.resolve(e)},function(e){n.state=L.state.initial,n.reject(e)}),o):(u=o,r.fulfill.length===0&&r.error.length===0?o=n:n.state===L.state.resolved&&r.fulfill.length>0?o=r.resolve(u):n.state===L.state.broken&&r.error.length>0&&(o=r.reject(u)),n.state=o.state,n.outcome=o.outcome,n.outcome)}},typeof e=="function"&&L.vouch.call(this,L.state.resolved,function(){return i(!0)}),typeof t=="function"&&L.vouch.call(this,L.state.broken,function(){return i(!1)}),r.parentNode=n,r}},factory:function(){return new A},resolve:function(e,t){var n=e===L.state.broken?"error":"fulfill",r=this,i=!1,s;if(this.state===L.state.pending)throw Error(x.error.promisePending);if(this.state!==L.state.initial)throw Error(x.error.promiseResolved.replace("{{outcome}}",this.outcome));this.state=e,this.outcome=t,d.each(this[n],function(e){s=e.call(this,t);if(s instanceof A)return i=!0,r.state=L.state.initial,r.outcome=null,!1});if(!i){this.error=[],this.fulfill=[];if(this.parentNode!==null&&this.parentNode.state===L.state.initial){s=this.parentNode[e===L.state.resolved?"resolve":"reject"](this.outcome);if(s instanceof A)return s}return typeof Object.freeze=="function"&&Object.freeze(this),this}return s},vouch:function(e,t){if(String(e).isEmpty())throw Error(x.error.invalidArguments);return this.state===L.state.initial?this[e===L.state.resolved?"fulfill":"error"].push(t):this.state===e&&t(this.outcome),this}};A.prototype=L.methods;var O={bang:/\#|\!\//g,nget:/^(head|options)$/i,methods:/^(all|delete|get|put|post|head|options)$/i,regex:new RegExp,routes:{all:{all:{error:function(){if(!!s)throw Error(x.error.invalidRoute);if(O.hash()==="")return history.go(-1);_.error(x.error.invalidRoute),o.route.initial!==null&&O.hash(o.route.initial)}},"delete":{},get:{},put:{},post:{}}},method:function(e){return O.methods.test(e)?e.toLowerCase():"all"},del:function(e,t,n){typeof n=="undefined"&&(n="all"),t=O.method(t);var r=e==="error";if(r&&t!=="all"||!r&&O.routes[n][t].hasOwnProperty(e))return o.route.initial===e&&(o.route.initial=null),delete O.routes[n][t][e];throw Error(x.error.invalidArguments)},hash:function(e){var n="";return s||(typeof e=="undefined"?n=t.location.hash.replace(O.bang,""):(n=e.replace(O.bang,""),t.location.hash="!/"+n)),n},hostname:function(e){return O.routes.hasOwnProperty(e)||(O.routes[e]={all:{},"delete":{},get:{},post:{},put:{}}),O.routes[e]},init:function(){var e=t.location.hash;return e.isEmpty()?O.hash(o.route.initial!==null?o.route.initial:d.cast(O.routes.all.all,!0).remove("error").first()):O.load(e),e.replace(O.bang,"")},list:function(e,t){typeof t=="undefined"&&(t="all");var n;return s?typeof e!="undefined"&&O.routes.hasOwnProperty(t)?n=d.cast(O.routes[t][O.method(e)],!0):(n=[],O.routes.hasOwnProperty(t)&&_.iterate(O.routes[t],function(e,t){n[t]=[],_.iterate(e,function(e,r){n[t].push(r)})})):n=d.cast(O.routes.all.all,!0),!s&&t!=="all"&&_.iterate(O.routes.all,function(e,t){typeof n[t]=="undefined"&&(n[t]=[]),_.iterate(e,function(e,r){n[t].push(r)})}),n},load:function(e,t,n,r){typeof n=="undefined"&&(n="all"),typeof r=="undefined"&&(r="all");var i="",s="",o=!0,u=O.method(n.method||n),a,f;return O.nget.test(u)&&(u="get"),e=e.replace(O.bang,""),a=function(e,t,n){typeof O.routes[e][t][n]!="undefined"?(i=n,s=t):t!=="all"&&typeof O.routes[e].all[n]!="undefined"?(i=n,s="all"):(_.iterate(O.routes[e][t],function(e,r){return f(r,t,n)}),i.isEmpty()&&t!=="all"&&_.iterate(O.routes[e].all,function(e,t){return f(t,"all",n)}))},f=function(e,t,n){if(_.compile(O.regex,"^"+e+"$","i")&&O.regex.test(n))return i=e,s=t,!1},r!=="all"&&!O.routes.hasOwnProperty(r)&&(r="all"),a(r,u,e),i.isEmpty()&&(r!=="all"&&(r="all",a(r,u,e)),i.isEmpty()&&(i="error",s="all",o=!1)),O.routes[r][s][i](t||i,n),o},server:function(e,t,n){var r,i,c;if(!s)return null;e=e||{},n=n===!0||e.port===443,r=function(e,t){var n=f.parse(e.url),r=e.headers.host.replace(/:.*/,"");O.load(n.pathname,t,e,r)},i=function(e){h(e,this,arguments),typeof t=="function"&&t(e)};if(!s)throw Error(x.error.notSupported);return l.route.enabled=o.route.enabled=!0,e.host=e.host||undefined,e.port=parseInt(e.port)||8e3,c=n?a.createServer(e,r).on("error",i).listen(e.port):u.createServer(r).on("error",i).listen(e.port,e.host),c},set:function(e,t,n,r){r=s?r||"all":"all",n=s?O.method(n):"all";if(typeof e!="string"||e.isEmpty()||typeof t!="function")throw Error(x.error.invalidArguments);return O.hostname(r)[n][e]=t,!0}},M={capitalize:function(e){return e=M.trim(e),e.charAt(0).toUpperCase()+e.slice(1)},escape:function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")},explode:function(e,t){if(typeof t=="undefined"||t.toString()==="")t=",";return M.trim(e).split(new RegExp("\\s*"+t+"\\s*"))},hyphenate:function(e,t){var n;return t=t===!0,n=M.trim(e).replace(/\s+/g,"-"),t&&(n=n.replace(/([A-Z])/g,"-$1").toLowerCase()),n},singular:function(e){return/s$/.test(e)?e.slice(0,-1):e},toCamelCase:function(e){var t=M.trim(e).toLowerCase().split(/\s|-/),n=[];return d.each(t,function(e,t){e=M.trim(e);if(e.isEmpty())return;n.push(t===0?e:M.capitalize(e))}),n.join("")},trim:function(e){return e.replace(/^\s+|\s+$/g,"")},uncapitalize:function(e){return e=M.trim(e),e.charAt(0).toLowerCase()+e.slice(1)}},_={timer:{},$:function(e,n){var r=[],i=[],o,u;return s||typeof e=="undefined"||String(e).indexOf("?")>-1?undefined:(e=e.trim(),n=n===!0,e.indexOf(",")>-1&&(e=e.explode()),e instanceof Array?(d.each(e,function(e){i.push(l(e,n))}),d.each(i,function(e){r=r.concat(e)}),r):(/\s|>/.test(e)?(u=d.last(e.split(" ").filter(function(e){if(M.trim(e)!==""&&e!==">")return!0})),o=t[u.indexOf("#")>-1&&u.indexOf(":")===-1?"querySelector":"querySelectorAll"](e)):e.indexOf("#")===0&&e.indexOf(":")===-1?o=isNaN(e.charAt(1))?t.querySelector(e):t.getElementById(e.substring(1)):e.indexOf("#")>-1&&e.indexOf(":")===-1?o=t.querySelector(e):o=t.querySelectorAll(e),typeof o!="undefined"&&o!==null&&!(o instanceof Element)&&!n&&(o=d.cast(o)),o===null&&(o=undefined),o))},alias:function(e,t){var n=e,r=t;return _.iterate(r,function(e,t){var i,s;e instanceof RegExp||typeof e!="function"?e instanceof RegExp||e instanceof Array||!(e instanceof Object)?(i=function(){return r[t]},s=function(e){r[t]=e},_.property(n,t,{enumerable:!0,get:i,set:s,value:r[t]})):(typeof n[t]=="undefined"&&(n[t]={}),_.alias(n[t],r[t])):n[t]=e.bind(n[t])}),e},clearTimers:function(e){if(typeof e=="undefined"||String(e).isEmpty())throw Error(x.error.invalidArguments);typeof _.timer[e]!="undefined"&&(clearTimeout(_.timer[e]),delete _.timer[e]),typeof l.repeating[e]!="undefined"&&(clearTimeout(l.repeating[e]),delete l.repeating[e])},clone:function(e){var t;return e instanceof Array?[].concat(e):typeof e=="boolean"?Boolean(e):typeof e=="function"?e:typeof e=="number"?Number(e):typeof e=="string"?String(e):!m.ie&&!s&&e instanceof Document?H.decode(H.encode(e)):e instanceof Object?(t=S.decode(S.encode(e)),typeof t!="undefined"&&(e.hasOwnProperty("constructor")&&(t.constructor=e.constructor),e.hasOwnProperty("prototype")&&(t.prototype=e.prototype)),t):e},coerce:function(e){var t=_.clone(e),n;return/^\d$/.test(t)?t=C.parse(t):/^(true|false)$/i.test(t)?t=/true/i.test(t):t==="undefined"?t=undefined:t==="null"?t=null:(n=S.decode(t,!0))&&typeof n!="undefined"&&(t=n),t},compile:function(e,t,n){return e.compile(t,n),!0},css:function(e,n){var r,i;return r=l("head")[0].create("style",{type:"text/css",media:n||"print, screen"}),r.styleSheet?r.styleSheet.cssText=e:(i=t.createTextNode(e),r.appendChild(i)),r},debounce:function(t,n,r){if(typeof t!="function")throw Error(x.error.invalidArguments);return n=n||1e3,r=r||e,function(){_.defer(function(){t.apply(r,arguments)},n)}},define:function(e,t,n){e=e.split(".");var r=n,i=e.length;return typeof n=="undefined"&&(n=this),typeof t=="undefined"&&(t=null),n===l&&(n=o),d.each(e,function(n,s){var o=s+1<i&&!isNaN(parseInt(e[s+1])),u=t;isNaN(parseInt(n))||(n=parseInt(n)),typeof r[n]=="undefined"?r[n]=o?[]:{}:r[n]instanceof Object&&o?r[n]=d.cast(r[n]):r[n]instanceof Object?void 0:r[n]instanceof Array&&!o?r[n]=r[n].toObject():r[n]={},s+1===i?r[n]=u:r=r[n]}),n},defer:function(e,t,n){var r;return t=t||0,n=n||_.guid(!0),r=function(){clearTimeout(_.timer[n]),delete _.timer[n],e()},_.timer[n]=setTimeout(r,t),undefined},domId:function(e){return"a"+e.replace(/-/g,"").slice(1)},error:function(e,t,n,r){var i;return typeof e!="undefined"&&(r=r===!0,i={arguments:t,message:typeof e.message!="undefined"?e.message:e,number:typeof e.number!="undefined"?e.number&65535:undefined,scope:n,stack:typeof e.stack=="string"?e.stack:undefined,timestamp:(new Date).toUTCString(),type:typeof e.type!="undefined"?e.type:"TypeError"},_.log(i.stack||i.message,r?"warn":"error"),l.error.log.push(i),k.fire(o,"error",i)),undefined},extend:function(e,t){var n,r;if(typeof e=="undefined")throw Error(x.error.invalidArguments);return typeof t=="undefined"&&(t={}),typeof Object.create=="function"?n=Object.create(e):(r=function(){},r.prototype=e,n=new r),_.merge(n,t),n},genId:function(e,t){t=t===!0;var n;if(typeof e!="undefined"&&(typeof e.id!="undefined"&&e.id!==""||e instanceof Array||e instanceof String||typeof e=="string"))return e;if(t){do n=_.domId(_.guid(!0));while(typeof l("#"+n)!="undefined")}else n=_.domId(_.guid(!0));return typeof e=="object"?(e.id=n,e):n},guid:function(e){var t=function(){return((1+Math.random())*65536|0).toString(16).substring(1)},n=[8,9,"a","b"],r;return e=e===!0,r=(t()+t()+"-"+t()+"-4"+t().substr(0,3)+"-"+n[Math.floor(Math.random()*n.length)]+t().substr(0,3)+"-"+t()+t()+t()).toLowerCase(),e&&(r=r.replace(/-/gi,"")),r},iterate:function(e,t){var n=Object.prototype.hasOwnProperty,r,i;if(typeof t!="function")throw Error(x.error.invalidArguments);for(r in e)if(n.call(e,r)){i=t.call(e,e[r],r);if(i===!1)break}return e},loading:function(e){var t=o.loading;e=_.object(e);if(e instanceof Array)return d.each(e,function(e){_.loading(e)});if(t.url===null)throw Error(x.error.elementNotFound);if(typeof e=="undefined")throw Error(x.error.invalidArguments);return typeof t.image=="undefined"&&(t.image=new Image,t.image.src=t.url),e.clear(),e.create("div",{"class":"loading"}).create("img",{alt:x.common.loading,src:t.image.src}),e},log:function(e,t){t=t||"log";var n=!s||typeof e!="object";return typeof console!="undefined"&&console[t]((n?"["+(new Date).toLocaleTimeString()+"] ":"")+e),undefined},merge:function(e,t){return _.iterate(t,function(t,n){e[n]=_.clone(t)}),e},module:function(e,t){if(typeof l[e]!="undefined"||typeof o[e]!="undefined"||!t instanceof Object)throw Error(x.error.invalidArguments);return o[e]=t,typeof t=="function"?l[e]=!m.ie||m.version>8?o[e].bind(l[e]):o[e]:(l[e]={},_.alias(l[e],o[e])),l[e]},object:function(e){return typeof e=="object"?e:e.toString().charAt(0)==="#"?l(e):e},parse:function(e){var r={},i={};return s?r=f.parse(e):(r=t.createElement("a"),r.href=e),i={protocol:r.protocol,hostname:r.hostname,port:String(r.port).isEmpty()?"":parseInt(r.port),pathname:r.pathname,search:r.search,hash:r.hash,host:r.host},m.ie&&(i.protocol===":"&&(i.protocol=n.protocol),i.hostname.isEmpty()&&(i.hostname=n.hostname),i.host.isEmpty()&&(i.host=n.host),i.pathname.charAt(0)!=="/"&&(i.pathname="/"+i.pathname)),i},property:function(e,t,n){var r;if(n instanceof Object)return r=(!m.ie||m.version>8)&&typeof Object.defineProperty=="function",r&&typeof n.value!="undefined"&&typeof n.get!="undefined"&&delete n.value,r?Object.defineProperty(e,t,n):e[t]=n.value,e;throw Error(x.error.invalidArguments)},proto:function(e,t){var n,r={array:{add:function(e){return d.add(this,e)},addClass:function(e){return d.each(this,function(t){t.addClass(e)})},after:function(e,t){var n=[];return d.each(this,function(r){n.push(r.after(e,t))}),n},append:function(e,t){var n=[];return d.each(this,function(r){n.push(r.append(e,t))}),n},attr:function(e,t){var n=[];return d.each(this,function(r){n.push(r.attr(e,t))}),n},before:function(e,t){var n=[];return d.each(this,function(r){n.push(r.before(e,t))}),n},chunk:function(e){return d.chunk(this,e)},clear:function(){return!s&&this[0]instanceof Element?d.each(this,function(e){e.clear()}):d.clear(this)},clone:function(){return _.clone(this)},collect:function(e){return d.collect(this,e)},compact:function(){return d.compact(this)},contains:function(e){return d.contains(this,e)},create:function(e,t,n){var r=[];return d.each(this,function(i){r.push(i.create(e,t,n))}),r},css:function(e,t){return d.each(this,function(n){n.css(e,t)})},data:function(e,t){var n=[];return d.each(this,function(r){n.push(r.data(e,t))}),n},diff:function(e){return d.diff(this,e)},disable:function(){return d.each(this,function(e){e.disable()})},destroy:function(){return d.each(this,function(e){e.destroy()}),[]},each:function(e){return d.each(this,e)},empty:function(){return d.empty(this)},enable:function(){return d.each(this,function(e){e.enable()})},equal:function(e){return d.equal(this,e)},fill:function(e,t,n){return d.fill(this,e,t,n)},find:function(e){var t=[];return d.each(this,function(n){n.find(e).each(function(e){t.contains(e)||t.push(e)})}),t},fire:function(){var e=arguments;return d.each(this,function(t){k.fire.apply(k,e)})},first:function(){return d.first(this)},flat:function(){return d.flat(this)},get:function(e,t){return d.each(this,function(n){n.get(e,t)}),[]},has:function(e){var t=[];return d.each(this,function(n){t.push(n.has(e))}),t},hasClass:function(e){var t=[];return d.each(this,function(n){t.push(n.hasClass(e))}),t},hide:function(){return d.each(this,function(e){e.hide()})},html:function(e){if(typeof e!="undefined")return d.each(this,function(t){t.html(e)});var t=[];return d.each(this,function(e){t.push(e.html())}),t},index:function(e){return d.index(this,e)},indexed:function(){return d.indexed(this)},intersect:function(e){return d.intersect(this,e)},is:function(e){var t=[];return d.each(this,function(n){t.push(n.is(e))}),t},isAlphaNum:function(){var e=[];return d.each(this,function(t){e.push(t.isAlphaNum())}),e},isBoolean:function(){var e=[];return d.each(this,function(t){e.push(t.isBoolean())}),e},isChecked:function(){var e=[];return d.each(this,function(t){e.push(t.isChecked())}),e},isDate:function(){var e=[];return d.each(this,function(t){e.push(t.isDate())}),e},isDisabled:function(){var e=[];return d.each(this,function(t){e.push(t.isDisabled())}),e},isDomain:function(){var e=[];return d.each(this,function(t){e.push(t.isDomain())}),e},isEmail:function(){var e=[];return d.each(this,function(t){e.push(t.isEmail())}),e},isEmpty:function(){var e=[];return d.each(this,function(t){e.push(t.isEmpty())}),e},isHidden:function(){var e=[];return d.each(this,function(t){e.push(t.isHidden())}),e},isIP:function(){var e=[];return d.each(this,function(t){e.push(t.isIP())}),e},isInt:function(){var e=[];return d.each(this,function(t){e.push(t.isInt())}),e},isNumber:function(){var e=[];return d.each(this,function(t){e.push(t.isNumber())}),e},isPhone:function(){var e=[];return d.each(this,function(t){e.push(t.isPhone())}),e},isUrl:function(){var e=[];return d.each(this,function(t){e.push(t.isUrl())}),e},keep_if:function(e){return d.keep_if(this,e)},keys:function(){return d.keys(this)},last:function(e){return d.last(this,e)},limit:function(e,t){return d.limit(this,e,t)},listeners:function(e){var t=[];return d.each(this,function(n){t=t.concat(n.listeners(e))}),t},loading:function(){return d.each(this,function(e){e.loading()})},max:function(){return d.max(this)},mean:function(){return d.mean(this)},median:function(){return d.median(this)},min:function(){return d.min(this)},mode:function(){return d.mode(this)},on:function(e,t,n,r,i){return d.each(this,function(s){s.on(e,t,n,typeof r!="undefined"?r:s,i)})},once:function(e,t,n,r,i){return d.each(this,function(s){s.once(e,t,n,typeof r!="undefined"?r:s,i)})},position:function(){var e=[];return d.each(this,function(t){e.push(t.position())}),e},prepend:function(e,t){var n=[];return d.each(this,function(r){n.push(r.prepend(e,t))}),n},range:function(){return d.range(this)},rassoc:function(e){return d.rassoc(this,e)},reject:function(e){return d.reject(this,e)},remove:function(e,t){return d.remove(this,e,t)},remove_if:function(e){return d.remove_if(this,e)},remove_while:function(e){return d.remove_while(this,e)},removeClass:function(e){return d.each(this,function(t){t.removeClass(e)})},replace:function(e){return d.replace(this,e)},rest:function(e){return d.rest(this,e)},rindex:function(e){return d.rindex(this,e)},rotate:function(e){return d.rotate(this,e)},serialize:function(e,t){return w.serialize(this,e,t)},series:function(e,t,n){return d.series(e,t,n)},show:function(){return d.each(this,function(e){e.show()})},size:function(){var e=[];return d.each(this,function(t){e.push(t.size())}),e},split:function(e){return d.split(this,e)},sum:function(){return d.sum(this)},take:function(e){return d.take(this,e)},text:function(e){return d.each(this,function(t){typeof t!="object"&&(t=_.object(t)),typeof t.text=="function"&&t.text(e)})},tpl:function(e){return d.each(this,function(t){t.tpl(e)})},toggleClass:function(e){return d.each(this,function(t){t.toggleClass(e)})},total:function(){return d.total(this)},toObject:function(){return d.toObject(this)},un:function(e,t,n){return d.each(this,function(r){r.un(e,t,n)})},unique:function(){return d.unique(this)},update:function(e){return d.each(this,function(t){w.update(t,e)})},val:function(e){var t=[],n=null,r=!0;return d.each(this,function(i){n!==null&&(r=n===i.type),n=i.type,typeof i.val=="function"&&t.push(i.val(e))}),r?t[0]:t},validate:function(){var e=[];return d.each(this,function(t){e.push(t.validate())}),e},zip:function(){return d.zip(this,arguments)}},element:{addClass:function(e){return w.klass(this,e,!0)},after:function(e,t){return w.create(e,t,this,"after")},append:function(e,t){return w.create(e,t,this,"last")},attr:function(e,t){return w.attr(this,e,t)},before:function(e,t){return w.create(e,t,this,"before")},clear:function(){return w.clear(this)},create:function(e,t,n){return w.create(e,t,this,n)},css:function(e,t){return w.css(this,e,t)},data:function(e,t){return w.data(this,e,t)},destroy:function(){return w.destroy(this)},disable:function(){return w.disable(this)},enable:function(){return w.enable(this)},find:function(e){return w.find(this,e)},fire:function(){return k.fire.apply(k,[this].concat(d.cast(arguments)))},genId:function(){return _.genId(this)},get:function(e,t,n,r,i){var s=L.factory(),o=this;return s.then(function(e){return w.update(o,{innerHTML:e}),k.fire(o,"afterGet"),typeof t=="function"&&t.call(o,e),e},function(e){return w.update(o,{innerHTML:e||x.error.serverError}),k.fire(o,"failedGet"),typeof n=="function"&&n.call(o,e),e}),k.fire(this,"beforeGet"),e.get(function(e){s.resolve(e)},function(e){s.reject(e)},r,i),this},has:function(e){return w.has(this,e)},hasClass:function(e){return w.hasClass(this,e)},hide:function(){return w.hide(this)},html:function(e){return typeof e=="undefined"?this.innerHTML:this.update({innerHTML:e})},is:function(e){return w.is(this,e)},isAlphaNum:function(){return this.nodeName==="FORM"?!1:D.test({alphanum:typeof this.value!="undefined"?this.value:w.text(this)}).pass},isBoolean:function(){return this.nodeName==="FORM"?!1:D.test({"boolean":typeof this.value!="undefined"?this.value:w.text(this)}).pass},isChecked:function(){return this.nodeName!=="INPUT"?!1:this.attr("checked")},isDate:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isDate():w.text(this).isDate()},isDisabled:function(){return this.nodeName!=="INPUT"?!1:this.attr("disabled")},isDomain:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isDomain():w.text(this).isDomain()},isEmail:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isEmail():w.text(this).isEmail()},isEmpty:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isEmpty():w.text(this).isEmpty()},isHidden:function(e){return w.hidden(this)},isIP:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isIP():w.text(this).isIP()},isInt:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isInt():w.text(this).isInt()},isNumber:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isNumber():w.text(this).isNumber()},isPhone:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isPhone():w.text(this).isPhone()},isUrl:function(){return this.nodeName==="FORM"?!1:typeof this.value!="undefined"?this.value.isUrl():w.text(this).isUrl()},jsonp:function(e,t,n){var r=this,i=t,s;return s=function(e){var t=r,n=e,s=i,o,u,a;try{typeof s!="undefined"?(s=s.replace(/]|'|"/g,"").replace(/\./g,"[").split("["),s.each(function(e){n=n[isNaN(e)?e:parseInt(e)];if(typeof n=="undefined")throw Error(x.error.propertyNotFound)}),a=n):a=e}catch(f){a=x.error.serverError,h(f,arguments,this)}t.text(a)},m.jsonp(e,s,function(){r.text(x.error.serverError)},n),this},listeners:function(e){return k.list(this,e)},loading:function(){return _.loading(this)},on:function(e,t,n,r,i){return k.add(this,e,t,n,r,i)},once:function(e,t,n,r,i){return k.once(this,e,t,n,r,i)},prepend:function(e,t){return w.create(e,t,this,"first")},prependChild:function(e){return w.prependChild(this,e)},position:function(){return w.position(this)},removeClass:function(e){return w.klass(this,e,!1)},serialize:function(e,t){return w.serialize(this,e,t)},show:function(){return w.show(this)},size:function(){return w.size(this)},text:function(e){return w.text(this,e)},toggleClass:function(e){return w.toggleClass(this,e)},tpl:function(e){return _.tpl(e,this)},un:function(e,t,n){return k.remove(this,e,t,n)},update:function(e){return w.update(this,e)},val:function(e){return w.val(this,e)},validate:function(){return this.nodeName==="FORM"?D.test(this):typeof this.value!="undefined"?!this.value.isEmpty():!w.text(this).isEmpty()}},"function":{reflect:function(){return _.reflect(this)},debounce:function(e){return _.debounce(this,e)}},number:{diff:function(e){return C.diff(this,e)},fire:function(){return k.fire.apply(k,[this.toString()].concat(d.cast(arguments)))},format:function(e,t){return C.format(this,e,t)},half:function(e){return C.half(this,e)},isEven:function(){return C.even(this)},isOdd:function(){return C.odd(this)},listeners:function(e){return k.list(this.toString(),e)},on:function(e,t,n,r,i){return k.add(this.toString(),e,t,n,r||this,i),this},once:function(e,t,n,r,i){return k.once(this.toString(),e,t,n,r||this,i),this},random:function(){return C.random(this)},roundDown:function(){return C.round(this,"down")},roundUp:function(){return C.round(this,"up")},un:function(e,t,n){return k.remove(this.toString(),e,t,n),this}},string:{allows:function(e){return m.allows(this,e)},capitalize:function(){return M.capitalize(this)},del:function(e,t,n){return m.request(this,"DELETE",e,t,null,n)},escape:function(){return M.escape(this)},expire:function(e){return v.expire(this,e)},explode:function(e){return M.explode(this,e)},fire:function(){return k.fire.apply(k,[this].concat(d.cast(arguments)))},get:function(e,t,n){return m.request(this,"GET",e,t,null,n)},headers:function(e,t){return m.request(this,"HEAD",e,t)},hyphenate:function(e){return M.hyphenate(this,e)},isAlphaNum:function(){return D.test({alphanum:this}).pass},isBoolean:function(){return D.test({"boolean":this}).pass},isDate:function(){return D.test({date:this}).pass},isDomain:function(){return D.test({domain:this}).pass},isEmail:function(){return D.test({email:this}).pass},isEmpty:function(){return M.trim(this)===""},isIP:function(){return D.test({ip:this}).pass},isInt:function(){return D.test({integer:this}).pass},isNumber:function(){return D.test({number:this}).pass},isPhone:function(){return D.test({phone:this}).pass},isUrl:function(){return D.test({url:this}).pass},jsonp:function(e,t,n){return m.jsonp(this,e,t,n)},listeners:function(e){return k.list(this,e)},post:function(e,t,n,r){return m.request(this,"POST",e,t,n,r)},put:function(e,t,n,r){return m.request(this,"PUT",e,t,n,r)},on:function(e,t,n,r,i){return k.add(this,e,t,n,r,i)},once:function(e,t,n,r,i){return k.add(this,e,t,n,r,i)},options:function(e,t){return m.request(this,"OPTIONS",e,t)},permissions:function(){return m.permissions(this)},singular:function(){return M.singular(this)},toCamelCase:function(){return M.toCamelCase(this)},toNumber:function(e){return C.parse(this,e)},trim:function(){return M.trim(this)},un:function(e,t,n){return k.remove(this,e,t,n)},uncapitalize:function(){return M.uncapitalize(this)}}};return _.iterate(r[t],function(t,n){_.property(e.prototype,n,{value:t,configurable:!0,writable:!0})}),e},queryString:function(e){var t={},r=n.search.isEmpty()?null:n.search.replace("?",""),i;return e=e||".*",r!==null&&(r=r.split("&"),d.each(r,function(e){i=e.split("=");if(i[0].isEmpty())return;typeof i[1]=="undefined"||i[1].isEmpty()?i[1]="":i[1].isNumber()?i[1]=Number(i[1]):i[1].isBoolean()&&(i[1]=i[1]==="true"),typeof t[i[0]]=="undefined"?t[i[0]]=i[1]:t[i[0]]instanceof Array?t[i[0]].push(i[1]):(t[i[0]]=[t[i[0]]],t[i[0]].push(i[1]))})),t},reflect:function(e){return typeof e=="undefined"&&(e=this),typeof e=="undefined"&&(e=l),e=e.toString().match(/function\s+\w*\s*\((.*?)\)/)[1],e!==""?e.explode():[]},repeat:function(e,t,n,r){t=t||10,n=n||_.guid(!0),r=r!==!1;if(r&&e()===!1)return;return _.defer(function(){var r=function(e,t,n){var r=this;e()!==!1?l.repeating[n]=setTimeout(function(){r.call(r,e,t,n)},t):delete l.repeating[n]};r.call(r,e,t,n)},t,n),n},script:function(e,t,n){return w.create("script",{type:"application/javascript",src:e},t||l("head")[0],n)},stylesheet:function(e,t){return w.create("link",{rel:"stylesheet",type:"text/css",href:e,media:t||"print, screen"},l("head")[0])},stop:function(e){return typeof e.cancelBubble!="undefined"&&(e.cancelBubble=!0),typeof e.preventDefault=="function"&&e.preventDefault(),typeof e.stopPropagation=="function"&&e.stopPropagation(),e.returnValue=!1,e},tpl:function(e,n){var r;if(typeof e!="object"||!/object|undefined/.test(typeof n)&&typeof (n=n.charAt(0)==="#"?l(n):l(n)[0])=="undefined")throw Error(x.error.invalidArguments);return typeof n=="undefined"&&(n=l("body")[0]),r=t.createDocumentFragment(),e instanceof Array?d.each(e,function(e,t){w.create(d.cast(e,!0)[0],r).html(d.cast(e)[0])}):_.iterate(e,function(e,t){typeof e=="string"?w.create(t,r).html(e):(e instanceof Array||e instanceof Object)&&_.tpl(e,w.create(t,r))}),n.appendChild(r),d.last(n.childNodes)},walk:function(e,t){return d.each(t.replace(/\]$/,"").replace(/\]/g,".").split(/\.|\[/),function(t){e=e[t]}),e}},D={pattern:{alphanum:/^[a-zA-Z0-9]+$/,"boolean":/^(0|1|true|false)?$/,domain:/^[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&amp;:\/~\+#]*[\w\-\@?^=%&amp;\/~\+#])?/,email:/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,ip:/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,integer:/(^-?\d\d*$)/,notEmpty:/\w{1,}/,number:/(^-?\d\d*\.\d*$)|(^-?\d\d*$)|(^-?\.\d\d*$)/,phone:/^([0-9\(\)\/\+ \-\.]+)$/,url:/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i},test:function(e){var t=!1,n=[],r={},i=null,s=[],o=[],u=[],a=[],f,c,h,p,v;return typeof e.nodeName!="undefined"&&e.nodeName==="FORM"?(e.id.isEmpty()&&e.genId(),u=l("#"+e.id+" input"),a=l("#"+e.id+" select"),u.length>0&&(o=o.concat(u)),a.length>0&&(o=o.concat(a)),d.each(o,function(e){var r={},i,s,o;i=D.pattern[e.nodeName.toLowerCase()]?D.pattern[e.nodeName.toLowerCase()]:!e.id.isEmpty()&&D.pattern[e.id.toLowerCase()]?D.pattern[e.id.toLowerCase()]:"notEmpty",s=e.val(),s===null&&(s=""),r[i]=s,o=D.test(r),o.pass||(n.push({element:e,test:i,value:s}),t=!0)})):_.iterate(e,function(e,r){if(typeof r=="undefined"||typeof e=="undefined"){n.push({test:r,value:e}),t=!0;return}i=String(e).charAt(0)==="#"?typeof l(e)!="undefined"?l(e).val():"":e;switch(r){case"date":isNaN((new Date(i)).getYear())&&(n.push({test:r,value:i}),t=!0);break;case"domain":D.pattern.domain.test(i.replace(/.*\/\//,""))||(n.push({test:r,value:i}),t=!0);break;case"domainip":if(!D.pattern.domain.test(i.replace(/.*\/\//,""))||!D.pattern.ip.test(i))n.push({test:r,value:i}),t=!0;break;default:c=typeof D.pattern[r]!="undefined"?D.pattern[r]:r,c.test(i)||(n.push({test:r,value:i}),t=!0)}}),{pass:!t,invalid:n}}},P=function(){var e=0,t=1,n=2,r=3,i=4,s=RegExp(n+"|"+r),o,l,c,h,p;return l={"User-Agent":"abaaso/3.3.13 node.js/"+process.versions.node.replace(/^v/,"")+" ("+M.capitalize(process.platform)+" V8/"+process.versions.v8+")","Content-Type":"text/plain",Accept:"*/*"},p=function(e){return this.readyState!==e&&(this.readyState=e,this.dispatchEvent("readystatechange"),this.readyState===i&&!this._error&&(this.dispatchEvent("load"),this.dispatchEvent("loadend"))),this},c=function(e){var t=this;p.call(this,n),this.status=e.statusCode,this._resheaders=e.headers,typeof this._resheaders["set-cookie"]!="undefined"&&this._resheaders["set-cookie"]instanceof Array&&(this._resheaders["set-cookie"]=this._resheaders["set-cookie"].join(";")),e.on("data",function(n){e.setEncoding("utf8"),t._send&&(n&&(t.responseText+=n),p.call(t,r))}),e.on("end",function(){t._send&&(p.call(t,i),t._send=!1)}),e.on("close",function(e){h.call(t,e)})},h=function(e){this.status=503,this.statusText=e,this.responseText=e.stack||e,this._error=!0,this.dispatchEvent("error"),p.call(this,i)},o=function(){this.onabort=null,this.onerror=null,this.onload=null,this.onloadend=null,this.onloadstart=null,this.onreadystatechange=null,this.readyState=e,this.response=null,this.responseText="",this.responseType="",this.responseXML=null,this.status=e,this.statusText="",this._id=_.genId(),this._error=!1,this._headers={},this._listeners={},this._params={},this._request=null,this._resheaders={},this._send=!1},o.prototype.abort=function(){this._request!==null&&(this._request.abort(),this._request=null),this.responseText="",this.responseXML="",this._error=!0,this._headers={};if(this._send===!0||s.test(this.readyState))this._send=!1,p.call(this,i);return this.dispatchEvent("abort"),this.readyState=e,this},o.prototype.addEventListener=function(e,t){return this._listeners.hasOwnProperty(e)||(this._listeners[e]=[]),this._listeners[e].add(t),this},o.prototype.dispatchEvent=function(e){var t=this;return typeof this["on"+e]=="function"&&this["on"+e](),this._listeners.hasOwnProperty(e)&&d.each(this._listeners[e],function(e){typeof e=="function"&&e.call(t)}),this},o.prototype.getAllResponseHeaders=function(){var e="";if(this.readyState<n||this._error)throw Error("INVALID_STATE_ERR: Headers have not been received");return _.iterate(this._resheaders,function(t,n){e+=n+": "+t+"\n"}),e},o.prototype.getResponseHeader=function(e){var t;if(this.readyState<n||this._error)throw Error("INVALID_STATE_ERR: Headers have not been received");return t=this._resheaders[e]||this._resheaders[e.toLowerCase()],t},o.prototype.open=function(e,n,r,i,s){var o=this;if(typeof r!="undefined"&&r!==!0)throw Error("Synchronous XMLHttpRequest requests are not supported");return this.abort(),this._error=!1,this._params={method:e,url:n,async:r||!0,user:i||null,password:s||null},_.iterate(l,function(e,t){o._headers[t]=e}),this.readyState=t,this},o.prototype.overrideMimeType=function(e){return this._headers["Content-Type"]=e,this},o.prototype.removeEventListener=function(e,t){if(!this._listeners.hasOwnProperty(e))return;return this._listeners[e].remove(t),this},o.prototype.send=function(e){e=e||null;var n=this,r,i,s,o;if(this.readyState<t)throw Error("INVALID_STATE_ERR: Object is not open");if(this._send)throw Error("INVALID_STATE_ERR: Object is sending");return i=f.parse(this._params.url),i.port=i.port||(i.protocol==="https:"?443:80),this._params.user!==null&&this._params.password!==null&&(i.auth=this._params.user+":"+this._params.password),/post|put/i.test(this._params.method)&&(this._headers["Content-Length"]=e!==null?Buffer.byteLength(e):0),this._headers.Host=i.hostname+(/80|443/.test(i.port)?"":":"+i.port),r={hostname:i.hostname,path:i.path,port:i.port,method:this._params.method,headers:this._headers},typeof i.auth!="undefined"&&(r.auth=i.auth),n._send=!0,n.dispatchEvent("readystatechange"),o=i.protocol==="http:"?u:a,s=o.request(r,function(e){c.call(n,e)}).on("error",function(e){h.call(n,e)}),e===null?s.setSocketKeepAlive(!0,1e4):s.write(e,"utf8"),this._request=s,s.end(),n.dispatchEvent("loadstart"),this},o.prototype.setRequestHeader=function(e,n){if(this.readyState!==t)throw Error("INVALID_STATE_ERR: Object is not usable");if(this._send)throw Error("INVALID_STATE_ERR: Object is sending");return this._headers[e]=n,this},o},H={decode:function(e){try{var t;if(typeof e!="string"||e.isEmpty())throw Error(x.error.invalidArguments);return m.ie?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t}catch(n){return h(n,arguments,this),undefined}},encode:function(e,t){try{if(typeof e=="undefined")throw Error(x.error.invalidArguments);t=t!==!1;var n=t?"<xml>":"",r=arguments[2]!==!1,i,s;return e!==null&&typeof e.xml!="undefined"&&(e=e.xml),e instanceof Document&&(e=(new XMLSerializer).serializeToString(e)),i=function(e,t){var n="<n>v</n>";return/\&|\<|\>|\"|\'|\t|\r|\n|\@|\$/g.test(t)&&(n=n.replace(/v/,"<![CDATA[v]]>")),n.replace(/n/g,e).replace(/v/,t)},/boolean|number|string/.test(typeof e)?n+=i("item",e):typeof e=="object"&&_.iterate(e,function(e,t){n+=H.encode(e,typeof e=="object",!1).replace(/item|xml/g,isNaN(t)?t:"item")}),n+=t?"</xml>":"",r&&(n='<?xml version="1.0" encoding="UTF8"?>'+n),n}catch(o){return h(o,arguments,this),undefined}}};return h=_.error,c=function(){var r,i;typeof o.bootstrap=="function"&&delete o.bootstrap,o.client.size=m.size(),m.version(),m.mobile(),m.tablet();if(m.ie&&m.version<8)return;r=function(e){var t=[];k.remove(e),e.childNodes.length>0&&(t=d.cast(e.childNodes)),t.length>0&&t.each(function(e){r(e)})},i=function(e){if(/complete|loaded/.test(t.readyState))return typeof o.init=="function"&&o.init(),!1},typeof Array.prototype.filter=="undefined"&&(Array.prototype.filter=function(e){if(this===void 0||this===null||typeof e!="function")throw Error(x.error.invalidArguments);var t=null,n=Object(this),r=n.length>>>0,i=[],s=arguments[1],o=null;for(t=0;t<r;t++)t in n&&(o=n[t],e.call(s,o,t,n)&&i.push(o));return i}),typeof Array.prototype.forEach=="undefined"&&(Array.prototype.forEach=function(e,t){if(this===null||typeof e!="function")throw Error(x.error.invalidArguments);var n,r=0,i=Object(this),s=i.length>>>0;t&&(n=t);while(r<s){var o;r in i&&(o=i[r],e.call(n,o,r,i)),r++}}),typeof Array.prototype.indexOf=="undefined"&&(Array.prototype.indexOf=function(e,t){for(var n=t||0,r=this.length;n<r;n++)if(this[n]===e)return n;return-1}),typeof Array.prototype.map=="undefined"&&(Array.prototype.map=function(e,t){var n,r,i;if(this==null)throw new TypeError(" this is null or not defined");var s=Object(this),o=s.length>>>0;if({}.toString.call(e)!="[object Function]")throw new TypeError(e+" is not a function");t&&(n=t),r=new Array(o),i=0;while(i<o){var u,a;i in s&&(u=s[i],a=e.call(n,u,i,s),r[i]=a),i++}return r}),typeof Array.prototype.reduce=="undefined"&&(Array.prototype.reduce=function(e){if(this===null||this===undefined)throw new TypeError("Object is null or undefined");var t=0,n=this.length>>0,r;if(typeof e!="function")throw new TypeError("First argument is not callable");if(arguments.length<2){if(n===0)throw new TypeError("Array length is 0 and no second argument");r=this[0],t=1}else r=arguments[1];while(t<n)t in this&&(r=e.call(undefined,r,this[t],t,this)),++t;return r}),!s&&typeof t.documentElement.classList=="undefined"&&function(e){var t,n,r,i,s;if(!("HTMLElement"in e||"Element"in e))return;t=function(e){var t=e.className.isEmpty()?[]:e.className.explode(" "),n=this;t.each(function(e){n.push(e)}),this.updateClassName=function(){e.className=this.join(" ")}},n=function(){return new t(this)},r=t.prototype=[],i=(e.HTMLElement||e.Element).prototype,r.add=function(e){d.contains(this,e)||(this.push(e),this.updateClassName())},r.contains=function(e){return d.contains(this,e)},r.remove=function(e){d.contains(this,e)&&(d.remove(this,e),this.updateClassName())},r.toggle=function(e){d[d.contains(this,e)?"remove":"add"](this,e),this.updateClassName()};if(Object.defineProperty)s={get:n,enumerable:!m.ie||m.version>8?!0:!1,configurable:!0},Object.defineProperty(i,"classList",s);else{if(!Object.prototype.__defineGetter__)throw Error("Could not create classList shim");i.__defineGetter__("classList",n)}}(e),typeof Function.prototype.bind=="undefined"&&(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice,r=n.call(arguments,1);return function(){return t.apply(e,r.concat(n.call(arguments)))}}),s&&(delete o.cookie,XMLHttpRequest=P()),l=o.$.bind(l),_.alias(l,o),delete l.$,delete l.bootstrap,delete l.callback,delete l.init,delete l.loading,o.route.initial=null,l.loading=o.loading.create.bind(l.loading),l.fire=o.fire,l.on=o.on,l.once=o.once,l.un=o.un,l.listeners=o.listeners,o.state._current=o.state.current="active",l.state._current=l.state.current=o.state.current,s||(typeof e.$=="undefined"||e.$===null?e.$=l:(e.a$=l,o.aliased="a$")),_.proto(Array,"array"),typeof Element!="undefined"&&_.proto(Element,"element"),m.ie&&m.version===8&&_.proto(HTMLDocument,"element"),_.proto(Function,"function"),_.proto(Number,"number"),_.proto(String,"string"),l.error.log=o.error.log=[],l.on(e,"error",function(e){l.fire("error",e)},"error",e,"all"),s||(l.on(e,"hashchange",function(){l.fire("beforeHash, hash, afterHash",n.hash)},"hash",e,"all"),l.on(e,"resize",function(){l.client.size=o.client.size=m.size(),l.fire("resize",o.client.size)},"resize",e,"all"),l.on(e,"load",function(){l.fire("render").un("render").un(this,"load")}),l.on(e,"DOMNodeInserted",function(e){var t=e.target;typeof t.id!="undefined"&&t.id.isEmpty()&&(_.genId(t),t.parentNode instanceof Element&&t.parentNode.fire("afterCreate",t),l.fire("afterCreate",t)),typeof Object.observe=="function"&&Object.observe(t,function(e){t.fire("change",e)})},"mutation",e,"all"),l.on(e,"DOMNodeRemoved",function(e){r(e.target)},"mutation",e,"all"),l.on("hash",function(e){(l.route.enabled||o.route.enabled)&&O.load(e)},"route",o.route,"all"));var u,a;u=function(){return this._current},a=function(e){if(e===null||typeof e!="string"||this.current===e||e.isEmpty())throw Error(x.error.invalidArguments);return o.state.previous=o.state._current,o.state._current=e,o.fire(e)},!m.ie||m.version>8?(_.property(o.state,"current",{enumerable:!0,get:u,set:a}),_.property(l.state,"current",{enumerable:!0,get:u,set:a})):(o.state.change=function(e){return a.call(o.state,e),o.state.current=e},l.state.change=function(e){return a.call(o.state,e),o.state.current=e}),l.ready=!0;switch(!0){case s:o.init();break;case typeof e.define=="function":e.define("abaaso",function(){return o.init()});break;case/complete|loaded/.test(t.readyState):o.init();break;case typeof t.addEventListener=="function":t.addEventListener("DOMContentLoaded",o.init,!1);break;case typeof t.attachEvent=="function":t.attachEvent("onreadystatechange",i);break;default:_.repeat(i)}},{array:d,callback:{},client:{android:m.android,blackberry:m.blackberry,chrome:m.chrome,firefox:m.firefox,ie:m.ie,ios:m.ios,linux:m.linux,mobile:m.mobile,opera:m.opera,osx:m.osx,playbook:m.playbook,safari:m.safari,tablet:m.tablet,size:{height:0,width:0},version:0,webos:m.webos,windows:m.windows,del:function(e,t,n,r,i){return m.request(e,"DELETE",t,n,null,r,i)},get:function(e,t,n,r,i){return m.request(e,"GET",t,n,null,r,i)},headers:function(e,t,n,r){return m.request(e,"HEAD",t,n,null,null,r)},post:function(e,t,n,r,i,s){return m.request(e,"POST",t,n,r,i,s)},put:function(e,t,n,r,i,s){return m.request(e,"PUT",t,n,r,i,s)},jsonp:function(e,t,n,r){return m.jsonp(e,t,n,r)},options:function(e,t,n,r){return m.request(e,"OPTIONS",t,n,null,null,r)},permissions:m.permissions},cookie:g,element:w,json:S,label:x,loading:{create:_.loading,url:null},message:T,mouse:N,number:C,repeating:{},route:{enabled:!1,del:O.del,hash:O.hash,init:O.init,list:O.list,load:O.load,server:O.server,set:O.set},state:{_current:null,header:null,previous:null},string:M,validate:D,xml:H,$:_.$,alias:_.alias,aliased:"$",allows:m.allows,append:function(e,t,n){return n instanceof Element&&n.genId(),w.create(e,t,n,"last")},bootstrap:c,clear:w.clear,clone:_.clone,coerce:_.coerce,compile:_.compile,create:w.create,css:_.css,data:y.factory,datalist:b.factory,discard:function(e){return k.discard(e!==!1)},debounce:_.debounce,decode:S.decode,defer:_.defer,define:_.define,del:function(e,t,n,r,i){return m.request(e,"DELETE",t,n,null,r,i)},destroy:w.destroy,encode:S.encode,error:_.error,expire:v.clean,expires:12e4,extend:_.extend,filter:E.factory,fire:function(e,t){var n=typeof e=="object",r=n?e:this!==l?this:o,i=n?t:e,s=[r,i].concat(d.cast(arguments).remove(0,n?1:0));return k.fire.apply(k,s)},genId:_.genId,get:function(e,t,n,r,i){return m.request(e,"GET",t,n,null,r,i)},guid:_.guid,hash:O.hash,headers:function(e,t,n,r){return m.request(e,"HEAD",t,n,null,{},r)},hidden:w.hidden,hook:k.hook,id:"abaaso",init:function(){return delete o.init,l.fire("init, ready").un("init, ready")},iterate:_.iterate,jsonp:function(e,t,n,r){return m.jsonp(e,t,n,r)},listeners:function(e,t){return e=typeof e=="object"?e:this!==l?this:o,k.list(e,t)},listenersTotal:k.sum,log:_.log,logging:k.log,merge:_.merge,module:_.module,object:_.object,on:function(e,t,n,r,i,s){var u=typeof e=="object",a,f,c,h,p,d;return a=u?e:this!==l?this:o,f=u?t:e,c=u?n:t,h=u?r:n,p=u?i:r,d=u?s:i,typeof p=="undefined"&&(p=a),k.add(a,f,c,h,p,d)},once:function(e,t,n,r,i,s){var u=typeof e=="object",a,f,c,h,p,d;return a=u?e:this!==l?this:o,f=u?t:e,c=u?n:t,h=u?r:n,p=u?i:r,d=u?s:i,typeof p=="undefined"&&(p=a),k.once(a,f,c,h,p,d)},options:function(e,t,n,r){return m.request(e,"OPTIONS",t,n,null,null,r)},parse:_.parse,pause:function(e){return k.pause(e!==!1)},permissions:m.permissions,position:w.position,post:function(e,t,n,r,i,s){return m.request(e,"POST",t,n,r,i,s)},prepend:function(e,t,n){return n instanceof Element&&n.genId(),w.create(e,t,n,"first")},promise:L.factory,property:_.property,put:function(e,t,n,r,i,s){return m.request(e,"PUT",t,n,r,i,s)},queryString:_.queryString,random:C.random,ready:!1,reflect:_.reflect,repeat:_.repeat,stylesheet:_.stylesheet,script:_.script,stop:_.stop,store:y.factory,tpl:_.tpl,un:function(e,t,n,r){var i=typeof e=="object",s,u,a,f;return s=i?e:this!==l?this:o,u=i?t:e,a=i?n:t,f=i?r:n,k.remove(s,u,a,f)},update:w.update,version:"3.3.13",walk:_.walk}}(),typeof o.bootstrap=="function"&&o.bootstrap(),typeof exports!="undefined"?module.exports=o:typeof define=="function"?define("abaaso",function(){return o}):e.abaaso=o})(this);